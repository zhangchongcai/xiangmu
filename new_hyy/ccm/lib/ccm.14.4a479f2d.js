webpackJsonpccm([14],{134:function(e,t,a){"use strict";function n(e){a(328)}Object.defineProperty(t,"__esModule",{value:!0});var i=a(278),o=a(333),r=a(3),s=n,l=r(i.a,o.a,!1,s,"data-v-217f83e0",null);t.default=l.exports},278:function(e,t,a){"use strict";var n=a(30),i=a.n(n),o=a(57),r=a(32),s=(a.n(r),a(330)),l=a(331),p=a(126);a.n(p);t.a={components:{searchLan:o.a,commonTable:l.a},mixins:[r.cacheMixin.cacheMixin],data:function(){return{cacheField:["searchConfig","tableData","pageConfig"],baseURL:this.$store.state.default.apiConfig.baseURL,modelName:"numberCreate",searchConfig:[{keyName:"batchCode",name:"批次号",type:"input",value:""},{keyName:"createTime",name:"创建日期",type:"date-picker",dateType:"date",value:""},{keyName:"queryCreateUserName",name:"创建人",type:"input",value:""}],searchParam:{},pageConfig:{start:0,pageSize:10,pageSizes:[10,20,30,40],currentPage:1,total:0},tableData:[],tableLabels:[{prop:"batchCode",label:"批次号",width:"250"},{prop:"couponCount",label:"数量",width:"150"},{prop:"couponColor",label:"票券颜色",width:"150"},{prop:"createTime",label:"创建日期",width:"150",hasTemplate:!0,formatRole:function(e){return Object(s.a)(new Date(e.row.createTime),"yyyy-MM-dd")}},{prop:"createUserName",label:"创建人",fixed:!0},{prop:"status",label:"状态",width:"150",hasTemplate:!0,formatRole:function(e){return 0==e.row.status?"待生成":1==e.row.status?"已生成":"票券已导出"}}],tableOptions:{label:"操作",fixed:"right",options:[{text:"导出",method:"exportTicketSure"}]}}},created:function(){this.search()},methods:{search:function(){var e=this.setParam();this.getData(e)},setParam:function(){var e=this,t="{}"!=i()(e.searchParam);return{batchCode:t?e.searchParam.batchCode:"",createTime:t&&e.searchParam.createTime?Object(s.a)(new Date(e.searchParam.createTime),"yyyy-MM-dd"):"",queryCreateUserName:t?e.searchParam.queryCreateUserName:"",pageNo:e.pageConfig.currentPage,pageSize:e.pageConfig.pageSize}},setSearch:function(e){this.searchParam=e,this.pageConfig.currentPage=1},getData:function(e){var t=this;this.$ccmList.getTicketNumerList(e).then(function(e){var a=e.flag,n=(e.msg,"warning");1==a&&(n="success"),"success"==n&&(t.tableData=e.data,t.pageConfig.total=e.pageNum)}).catch(function(e){console.log("查询错误,错误信息:"+e)})},handleButton:function(e){"exportTicketSure"==e.method&&this.exportTicketSure(e.scope)},exportTicketSure:function(e){var t=this,a=e.row.batchCode;if(0==e.row.status)return this.$message({type:"warning",message:"该票券处于待生成状态，无法导出！"});1==e.row.status&&t.exportTicket(a),2==e.row.status&&t.$confirm("该批票券编号已导出过，是否再次导出？","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(function(){t.exportTicket(a)}).catch(function(){})},exportTicket:function(e){var t=this,a="warning",n=this.baseURL+"/coupon/prebuild/exportExcel?batchCode="+e,i={};this.$store.state.CpmUserKey&&(i["Cpm-User-Token"]=this.$store.state.CpmUserKey),sessionStorage.getItem("token")&&(i["Cpm-User-Token"]=sessionStorage.getItem("token")),this.axios(n,{headers:i,method:"get",responseType:"blob"}).then(function(e){console.log(e);var n=e.headers.flag,i=e.msg?e.msg:"票券导出失败，请稍后尝试！";if("1"==n){a="success",i="票券导出成功！";var o=new Blob([e.data]),r=e.headers.filename,s=document.createElement("a");s.download=r,s.style.display="none",s.href=URL.createObjectURL(o),document.body.appendChild(s),s.click(),URL.revokeObjectURL(s.href),document.body.removeChild(s)}else"2"==n?i="该批次导出次数超出系统限制,无法导出":"3"==n&&(i="预生成批次不存在");t.$message({type:a,message:i})})},createNew:function(){this.$router.push({path:"addNumber"})},handleSizeChange:function(e){this.pageConfig.pageSize=e,this.pageConfig.currentPage=1,this.search()},handleCurrentChange:function(e){this.pageConfig.currentPage=e,this.search()}}}},279:function(e,t,a){"use strict";t.a={name:"commonTable",props:{tableData:{required:!0,type:Array,default:[]},tableLabels:{required:!0,type:Array,default:[]},tableOptions:{required:!0,type:Object,default:{}},selection:{required:!1,type:Boolean,default:!1}},data:function(){return{}},created:function(){},methods:{handleButton:function(e,t){this.$emit("handleButton",{method:e,scope:t})},handleSelectionChange:function(e){this.$emit("handleSelectionChange",e)}}}},328:function(e,t,a){var n=a(329);"string"==typeof n&&(n=[[e.i,n,""]]),n.locals&&(e.exports=n.locals);a(123)("3422f670",n,!0,{})},329:function(e,t,a){t=e.exports=a(122)(!0),t.push([e.i,"\n[data-v-217f83e0].pageStyle .el-input .el-input__inner {\n  font-size: 12px !important;\n  height: 24px !important;\n  color: #666666;\n}\n[data-v-217f83e0].pageStyle .el-pagination__sizes {\n  position: relative;\n  bottom: 1px;\n}\n[data-v-217f83e0].pageStyle .el-pagination .el-pagination__jump {\n  margin: 0 24px;\n}\n[data-v-217f83e0].pageStyle .el-pagination .el-pagination__total,[data-v-217f83e0].pageStyle .el-pagination .btn-prev,[data-v-217f83e0].pageStyle .el-pagination .el-pager li,[data-v-217f83e0].pageStyle .el-pagination .btn-next,[data-v-217f83e0].pageStyle .el-pagination .el-pagination__jump,[data-v-217f83e0].pageStyle .el-pagination .el-pagination__sizes {\n  font-size: 12px !important;\n  height: 24px;\n  line-height: 24px;\n  min-width: 24px;\n  border-radius: 4px;\n  background: #ffffff;\n  color: #666666;\n}\n[data-v-217f83e0].pageStyle .el-pagination .btn-prev,[data-v-217f83e0].pageStyle .el-pagination .el-pager li,[data-v-217f83e0].pageStyle .el-pagination .btn-next {\n  border: 1px solid #BCBCBC;\n}\nsection[data-v-217f83e0] {\n  margin-bottom: 15px;\n}\n.addBtn[data-v-217f83e0] {\n  width: 80px;\n  padding-left: 0;\n  padding-right: 0;\n  height: 32px;\n  font-size: 12px;\n  border-color: #3B74FF;\n  color: #3B74FF;\n}\n.autocollorr[data-v-217f83e0] {\n  color: red;\n}\n","",{version:3,sources:["G:/Workspaces/work/chenxin/module-hyy/ccm/src/views/coupon/numberCreate/index.vue"],names:[],mappings:";AACA;EACE,2BAA2B;EAC3B,wBAAwB;EACxB,eAAe;CAChB;AACD;EACE,mBAAmB;EACnB,YAAY;CACb;AACD;EACE,eAAe;CAChB;AACD;EACE,2BAA2B;EAC3B,aAAa;EACb,kBAAkB;EAClB,gBAAgB;EAChB,mBAAmB;EACnB,oBAAoB;EACpB,eAAe;CAChB;AACD;EACE,0BAA0B;CAC3B;AACD;EACE,oBAAoB;CACrB;AACD;EACE,YAAY;EACZ,gBAAgB;EAChB,iBAAiB;EACjB,aAAa;EACb,gBAAgB;EAChB,sBAAsB;EACtB,eAAe;CAChB;AACD;EACE,WAAW;CACZ",file:"index.vue",sourcesContent:["\n[data-v-217f83e0].pageStyle .el-input .el-input__inner {\n  font-size: 12px !important;\n  height: 24px !important;\n  color: #666666;\n}\n[data-v-217f83e0].pageStyle .el-pagination__sizes {\n  position: relative;\n  bottom: 1px;\n}\n[data-v-217f83e0].pageStyle .el-pagination .el-pagination__jump {\n  margin: 0 24px;\n}\n[data-v-217f83e0].pageStyle .el-pagination .el-pagination__total,[data-v-217f83e0].pageStyle .el-pagination .btn-prev,[data-v-217f83e0].pageStyle .el-pagination .el-pager li,[data-v-217f83e0].pageStyle .el-pagination .btn-next,[data-v-217f83e0].pageStyle .el-pagination .el-pagination__jump,[data-v-217f83e0].pageStyle .el-pagination .el-pagination__sizes {\n  font-size: 12px !important;\n  height: 24px;\n  line-height: 24px;\n  min-width: 24px;\n  border-radius: 4px;\n  background: #ffffff;\n  color: #666666;\n}\n[data-v-217f83e0].pageStyle .el-pagination .btn-prev,[data-v-217f83e0].pageStyle .el-pagination .el-pager li,[data-v-217f83e0].pageStyle .el-pagination .btn-next {\n  border: 1px solid #BCBCBC;\n}\nsection[data-v-217f83e0] {\n  margin-bottom: 15px;\n}\n.addBtn[data-v-217f83e0] {\n  width: 80px;\n  padding-left: 0;\n  padding-right: 0;\n  height: 32px;\n  font-size: 12px;\n  border-color: #3B74FF;\n  color: #3B74FF;\n}\n.autocollorr[data-v-217f83e0] {\n  color: red;\n}\n"],sourceRoot:""}])},330:function(e,t,a){"use strict";function n(e,t){try{/(y+)/.test(t)&&(t=t.replace(RegExp.$1,(e.getFullYear()+"").substr(4-RegExp.$1.length)));var a={"M+":e.getMonth()+1,"d+":e.getDate(),"h+":e.getHours(),"m+":e.getMinutes(),"s+":e.getSeconds()};for(var n in a)if(new RegExp("("+n+")").test(t)){var o=a[n]+"";t=t.replace(RegExp.$1,1===RegExp.$1.length?o:i(o))}return t}catch(e){return console.log(e),""}}function i(e){return("00"+e).substr(e.length)}t.a=n,Date.prototype.formatDate=Date.prototype.formatDate||function(e){return n(this,e)},Date.prototype.addDays=Date.prototype.addDays||function(e){return this.setDate(this.getDate()+e),this},Date.prototype.addWeeks=Date.prototype.addWeeks||function(e){return this.addDays(7*e),this},Date.prototype.addMonths=Date.prototype.addMonths||function(e){var t=this.getDate();return this.setMonth(this.getMonth()+e),this.getDate()<t&&this.setDate(0),this},Date.prototype.addYears=Date.prototype.addYears||function(e){var t=this.getMonth();return this.setFullYear(this.getFullYear()+e),t<this.getMonth()&&this.setDate(0),this}},331:function(e,t,a){"use strict";var n=a(279),i=a(332),o=a(3),r=o(n.a,i.a,!1,null,null,null);t.a=r.exports},332:function(e,t,a){"use strict";var n=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",[a("el-table",{staticStyle:{width:"100%"},attrs:{data:e.tableData,stripe:""},on:{"selection-change":e.handleSelectionChange}},[e.selection?a("el-table-column",{attrs:{type:"selection",width:"100"}}):e._e(),e._v(" "),e._l(e.tableLabels,function(t,n){return[t.hasTemplate?a("el-table-column",{key:n,attrs:{prop:t.prop?t.prop:"",label:t.label?t.label:"",width:t.width?t.width:"",fixed:t.fixed?t.fixed:"",sortable:!!t.sortable&&t.sortable},scopedSlots:e._u([{key:"default",fn:function(a){return[e._v("\n          "+e._s(t.formatRole(a))+"\n        ")]}}],null,!0)}):a("el-table-column",{key:n,attrs:{prop:t.prop?t.prop:"",label:t.label?t.label:"",width:t.width?t.width:"",fixed:t.fixed?t.fixed:""}}),e._v(" --\x3e\n    ")]}),e._v(" "),a("el-table-column",{attrs:{label:e.tableOptions.label?e.tableOptions.label:"",fixed:e.tableOptions.fixed?e.tableOptions.fixed:""},scopedSlots:e._u([{key:"default",fn:function(t){return e._l(e.tableOptions.options,function(n,i){return a("el-button",{key:i,attrs:{type:"text"},on:{click:function(a){return e.handleButton(n.method,t)}}},[e._v(e._s(n.text))])})}}])})],2)],1)},i=[],o={render:n,staticRenderFns:i};t.a=o},333:function(e,t,a){"use strict";var n=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"table-page"},[a("section",{staticClass:"search-section"},[a("searchLan",{attrs:{modelName:e.modelName,config:e.searchConfig},on:{pressSearch:e.search,searchValueChange:e.setSearch}})],1),e._v(" "),a("section",{staticClass:"btnGroup-section flex-base flex-end"},[a("el-row",[a("el-button",{staticStyle:{height:"32px"},attrs:{plain:"",type:"primary"},on:{click:e.createNew}},[e._v("新建预生成批次")])],1)],1),e._v(" "),a("section",{staticClass:"table-section"},[a("commonTable",{attrs:{tableData:e.tableData,tableLabels:e.tableLabels,tableOptions:e.tableOptions},on:{handleButton:e.handleButton}})],1),e._v(" "),0!=e.tableData.length?a("section",{staticClass:"pagination-section flex-base flex-center pageStyle"},[a("el-pagination",{attrs:{"current-page":e.pageConfig.currentPage,"page-sizes":e.pageConfig.pageSizes,"page-size":e.pageConfig.pageSize,background:"",layout:"total, prev, pager, next, jumper, sizes",total:e.pageConfig.total},on:{"size-change":e.handleSizeChange,"current-change":e.handleCurrentChange}})],1):e._e()])},i=[],o={render:n,staticRenderFns:i};t.a=o}});