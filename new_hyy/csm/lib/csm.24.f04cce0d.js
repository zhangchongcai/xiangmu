webpackJsonpcsm([24],{201:function(e,a,t){"use strict";var n=t(86),r=t.n(n),l=requireModule("base"),o=l.fixStepTool,s=l.fixStepToolMixin;a.a={name:"CinemaParam",mixins:[s],components:{fixStepTool:o},data:function(){var e=this;return{basicInfoFormData:{channelCode:"",channelName:"",company:"",type:"",channelUid:"",cinemaUid:""},tradeRuleFormData:{netSaleFeeMode:0,saleFeePercentage:"",saleFeeMoney:"",addFeeType:0,saleEndTimeType:0,saleEndTime:"",presalePlanDays:"",maxSaleTicketAmount:"",maxSaleGoodsAmount:"",refundRuleUid:""},tradeRuleFormDataRules:{saleFeePercentage:[{validator:function(a,t,n){if(t||2!==e.tradeRuleFormData.netSaleFeeMode){/^([1-9]\d?|100)$/.test(t)?n():n(new Error("百分比区间为1-100的整数"))}else n(new Error("请输入百分比"))},trigger:"blur"}],saleFeeMoney:[{validator:function(a,t,n){t||2===e.tradeRuleFormData.netSaleFeeMode?/^(\d{1,2}(\.\d{1,2})?|100)$/.test(t)?n():n(new Error("金额区间为0-100，最多两位小数")):n(new Error("请输入金额"))},trigger:"blur"}],addFeeType:[{required:!0,message:"请选择增值服务费",trigger:"change"}],saleEndTime:[{validator:function(a,t,n){t?/^100$|^(\d|[1-9]\d)$/.test(t)?n():n(new Error("时间区间为0-100")):2===e.tradeRuleFormData.saleEndTimeType?n():n(new Error("请输入时间"))},trigger:"blur"}],presalePlanDays:[{validator:function(e,a,t){a?/^([1-9]|[1-5][0-9]|60)$/.test(a)?t():t(new Error("天数区间为1-60")):t(new Error("请输入天数"))},trigger:"blur"}],maxSaleTicketAmount:[{validator:function(e,a,t){a?/^(?:[1-9]|1[0-9]|20)$/.test(a)?t():t(new Error("张数区间为1-20")):t(new Error("请输入张数"))},trigger:"blur"}],maxSaleGoodsAmount:[{validator:function(e,a,t){a?/^(?:[1-9]|1[0-9]|20)$/.test(a)?t():t(new Error("数量区间为1-20")):t(new Error("请输入数量"))},trigger:"blur"}]},refundRuleUidOptions:[],netSaleFeeModeOptions:[{keyName:"最高限额",keyCode:0},{keyName:"固定金额",keyCode:1},{keyName:"标准价百分比",keyCode:2}],tradeRuleShow:!0,mode:"add",activeNames:["basicInfo","tradeRule","businessPermission"],activeTab:"first",stepData:{stepEl:".el-collapse-item",stepList:[{name:"基础信息",isactive:!1},{name:"交易规则",isactive:!1}]}}},methods:{cancel:function(){this.$router.push({path:"/trade/cinemaChannel"})},netSaleFeeModeChange:function(e){console.log(e),this.tradeRuleFormData.saleFeePercentage="",this.tradeRuleFormData.saleFeeMoney="",this.$refs.tradeRuleFormData.clearValidate(["saleFeePercentage","saleFeeMoney"])},saleEndTimeTypeChange:function(e){console.log(e),this.tradeRuleFormData.saleEndTime="",this.$refs.tradeRuleFormData.clearValidate("saleEndTime")},saveCinemaParams:function(){var e=this;console.log(this.basicInfoFormData,this.tradeRuleFormData),this.tradeRuleShow?this.$refs.tradeRuleFormData.validate(function(a){a&&("add"===e.mode?e.addChannelCinema(r()(e.basicInfoFormData,e.tradeRuleFormData)):"update"===e.mode&&e.updateChannelCinema(r()(e.basicInfoFormData,e.tradeRuleFormData)))}):"add"===this.mode?this.addChannelCinema(this.basicInfoFormData):"update"===this.mode&&this.updateChannelCinema(this.basicInfoFormData)},getChannelDetail:function(e,a){var t=this;this.$csmList.getChannelDetail({channelUid:e,cinemaUid:a}).then(function(e){console.log(e),200===e.code?e.data&&(t.mode="update",t.tradeRuleFormData=e.data):t.error(e.msg)})},addChannelCinema:function(e){var a=this;this.$csmList.addChannelCinema(e).then(function(e){console.log(e),200===e.code?(a.success("保存成功！"),a.$router.push({path:"/trade/cinemaChannel"})):a.error(e.msg)})},updateChannelCinema:function(e){var a=this;this.$csmList.updateChannelCinema(e).then(function(e){console.log(e),200===e.code?(a.success("保存成功！"),a.$router.push({path:"/trade/cinemaChannel"})):a.error(e.msg)})},initData:function(){this.basicInfoFormData.channelCode=this.$route.query.data.code,this.basicInfoFormData.channelName=this.$route.query.data.name,this.basicInfoFormData.company=this.$route.query.data.company,this.basicInfoFormData.type=this.$route.query.data.nature,this.basicInfoFormData.channelUid=this.$route.query.data.uid,this.basicInfoFormData.cinemaUid=this.$route.query.cinemaUid}},created:function(){"0"!==this.$route.query.data.uid&&"1"!==this.$route.query.data.uid||(this.tradeRuleShow=!1,this.stepData.stepList=this.stepData.stepList.filter(function(e){return"交易规则"!==e.name}))},mounted:function(){console.log(this.$route.query),this.initData(),this.getChannelDetail(this.$route.query.data.uid,this.$route.query.cinemaUid)}}},323:function(e,a,t){var n=t(324);"string"==typeof n&&(n=[[e.i,n,""]]),n.locals&&(e.exports=n.locals);t(52)("5f12bfc1",n,!0,{})},324:function(e,a,t){a=e.exports=t(51)(!0),a.push([e.i,"\n.cinemaParam {\n  width: 80%;\n}\n.cinemaParam .basicInfo .el-form-item {\n    width: 40%;\n}\n.cinemaParam .btn-area {\n    text-align: center;\n}\n.cinemaParam .btn-area .el-button {\n      padding: 8px 16px;\n      min-width: 80px;\n      height: 32px;\n}\n.cinemaParam .btn-area .el-button + .el-button {\n      margin-left: 30px;\n}\n","",{version:3,sources:["G:/Workspaces/work/chenxin/module-hyy/csm/src/views/channelManage/CinemaParam.vue"],names:[],mappings:";AACA;EACE,WAAW;CACZ;AACD;IACI,WAAW;CACd;AACD;IACI,mBAAmB;CACtB;AACD;MACM,kBAAkB;MAClB,gBAAgB;MAChB,aAAa;CAClB;AACD;MACM,kBAAkB;CACvB",file:"CinemaParam.vue",sourcesContent:["\n.cinemaParam {\n  width: 80%;\n}\n.cinemaParam .basicInfo .el-form-item {\n    width: 40%;\n}\n.cinemaParam .btn-area {\n    text-align: center;\n}\n.cinemaParam .btn-area .el-button {\n      padding: 8px 16px;\n      min-width: 80px;\n      height: 32px;\n}\n.cinemaParam .btn-area .el-button + .el-button {\n      margin-left: 30px;\n}\n"],sourceRoot:""}])},325:function(e,a,t){"use strict";var n=function(){var e=this,a=e.$createElement,t=e._self._c||a;return t("section",{staticClass:"cinemaParam"},[t("el-collapse",{model:{value:e.activeNames,callback:function(a){e.activeNames=a},expression:"activeNames"}},[t("el-collapse-item",{attrs:{title:"基础信息",name:"basicInfo"}},[t("el-form",{staticClass:"basicInfo",attrs:{model:e.basicInfoFormData,inline:"","label-width":"100px"}},[t("el-form-item",{attrs:{label:"渠道编码："}},[t("span",[e._v(e._s(e.basicInfoFormData.channelCode))])]),e._v(" "),t("el-form-item",{attrs:{label:"渠道名称："}},[t("span",[e._v(e._s(e.basicInfoFormData.channelName))])]),e._v(" "),t("el-form-item",{attrs:{label:"公司全称："}},[t("span",[e._v(e._s(e.basicInfoFormData.company))])]),e._v(" "),t("el-form-item",{attrs:{label:"渠道类型："}},[1===e.basicInfoFormData.type||0===e.basicInfoFormData.type?t("span",[e._v("自营渠道")]):2===e.basicInfoFormData.type?t("span",[e._v("第三方渠道")]):e._e()])],1)],1),e._v(" "),e.tradeRuleShow?t("el-collapse-item",{attrs:{title:"交易规则",name:"tradeRule"}},[t("el-form",{ref:"tradeRuleFormData",attrs:{model:e.tradeRuleFormData,rules:e.tradeRuleFormDataRules,"label-width":"240px"}},[t("el-form-item",{attrs:{label:"网络代售费：",prop:2===e.tradeRuleFormData.netSaleFeeMode?"saleFeePercentage":"saleFeeMoney"}},[t("el-select",{attrs:{placeholder:"请选择"},on:{change:e.netSaleFeeModeChange},model:{value:e.tradeRuleFormData.netSaleFeeMode,callback:function(a){e.$set(e.tradeRuleFormData,"netSaleFeeMode",a)},expression:"tradeRuleFormData.netSaleFeeMode"}},e._l(e.netSaleFeeModeOptions,function(e){return t("el-option",{key:e.keyCode,attrs:{label:e.keyName,value:e.keyCode}})}),1),e._v(" "),t("span",{directives:[{name:"show",rawName:"v-show",value:2===e.tradeRuleFormData.netSaleFeeMode,expression:"tradeRuleFormData.netSaleFeeMode === 2"}]},[t("el-input",{staticStyle:{width:"100px"},attrs:{placeholder:"请输入"},model:{value:e.tradeRuleFormData.saleFeePercentage,callback:function(a){e.$set(e.tradeRuleFormData,"saleFeePercentage",a)},expression:"tradeRuleFormData.saleFeePercentage"}}),e._v(" %\n          ")],1),e._v(" "),t("span",{directives:[{name:"show",rawName:"v-show",value:2!==e.tradeRuleFormData.netSaleFeeMode,expression:"tradeRuleFormData.netSaleFeeMode !== 2"}]},[t("el-input",{staticStyle:{width:"100px"},attrs:{placeholder:"请输入"},model:{value:e.tradeRuleFormData.saleFeeMoney,callback:function(a){e.$set(e.tradeRuleFormData,"saleFeeMoney",a)},expression:"tradeRuleFormData.saleFeeMoney"}}),e._v(" 元\n          ")],1)],1),e._v(" "),t("el-form-item",{attrs:{label:"增值服务费：",prop:"addFeeType"}},[t("el-radio",{attrs:{label:0},model:{value:e.tradeRuleFormData.addFeeType,callback:function(a){e.$set(e.tradeRuleFormData,"addFeeType",a)},expression:"tradeRuleFormData.addFeeType"}},[e._v("系统设置")]),e._v(" "),t("el-radio",{attrs:{label:1},model:{value:e.tradeRuleFormData.addFeeType,callback:function(a){e.$set(e.tradeRuleFormData,"addFeeType",a)},expression:"tradeRuleFormData.addFeeType"}},[e._v("合作商设置")])],1),e._v(" "),t("el-form-item",{attrs:{label:"售票截止时间：",prop:"saleEndTime"}},[t("div",[t("el-radio",{attrs:{label:0},on:{change:e.saleEndTimeTypeChange},model:{value:e.tradeRuleFormData.saleEndTimeType,callback:function(a){e.$set(e.tradeRuleFormData,"saleEndTimeType",a)},expression:"tradeRuleFormData.saleEndTimeType"}},[e._v("放映前")]),e._v(" "),t("span",{directives:[{name:"show",rawName:"v-show",value:0===e.tradeRuleFormData.saleEndTimeType,expression:"tradeRuleFormData.saleEndTimeType === 0"}]},[t("el-input",{staticStyle:{width:"100px"},attrs:{placeholder:"请输入"},model:{value:e.tradeRuleFormData.saleEndTime,callback:function(a){e.$set(e.tradeRuleFormData,"saleEndTime",a)},expression:"tradeRuleFormData.saleEndTime"}}),e._v(" 分钟（最大100分钟）\n            ")],1)],1),e._v(" "),t("div",[t("el-radio",{attrs:{label:1},on:{change:e.saleEndTimeTypeChange},model:{value:e.tradeRuleFormData.saleEndTimeType,callback:function(a){e.$set(e.tradeRuleFormData,"saleEndTimeType",a)},expression:"tradeRuleFormData.saleEndTimeType"}},[e._v("放映后")]),e._v(" "),t("span",{directives:[{name:"show",rawName:"v-show",value:1===e.tradeRuleFormData.saleEndTimeType,expression:"tradeRuleFormData.saleEndTimeType === 1"}]},[t("el-input",{staticStyle:{width:"100px"},attrs:{placeholder:"请输入"},model:{value:e.tradeRuleFormData.saleEndTime,callback:function(a){e.$set(e.tradeRuleFormData,"saleEndTime",a)},expression:"tradeRuleFormData.saleEndTime"}}),e._v(" 分钟（最大100分钟）\n            ")],1)],1),e._v(" "),t("div",[t("el-radio",{attrs:{label:2},on:{change:e.saleEndTimeTypeChange},model:{value:e.tradeRuleFormData.saleEndTimeType,callback:function(a){e.$set(e.tradeRuleFormData,"saleEndTimeType",a)},expression:"tradeRuleFormData.saleEndTimeType"}},[e._v("放映结束前都可售票")])],1)]),e._v(" "),t("el-form-item",{attrs:{label:"渠道可预售排期天数：",prop:"presalePlanDays"}},[t("el-input",{staticStyle:{width:"100px"},attrs:{placeholder:"请输入"},model:{value:e.tradeRuleFormData.presalePlanDays,callback:function(a){e.$set(e.tradeRuleFormData,"presalePlanDays",a)},expression:"tradeRuleFormData.presalePlanDays"}}),e._v(" （最大60天）\n        ")],1),e._v(" "),t("el-form-item",{attrs:{label:"每笔订单可购影票最多张数：",prop:"maxSaleTicketAmount"}},[t("el-input",{staticStyle:{width:"100px"},attrs:{placeholder:"请输入"},model:{value:e.tradeRuleFormData.maxSaleTicketAmount,callback:function(a){e.$set(e.tradeRuleFormData,"maxSaleTicketAmount",a)},expression:"tradeRuleFormData.maxSaleTicketAmount"}}),e._v(" （最大20张）\n        ")],1),e._v(" "),t("el-form-item",{attrs:{label:"每笔订单可购卖品最多数量：",prop:"maxSaleGoodsAmount"}},[t("el-input",{staticStyle:{width:"100px"},attrs:{placeholder:"请输入"},model:{value:e.tradeRuleFormData.maxSaleGoodsAmount,callback:function(a){e.$set(e.tradeRuleFormData,"maxSaleGoodsAmount",a)},expression:"tradeRuleFormData.maxSaleGoodsAmount"}}),e._v(" （最大20笔）\n        ")],1)],1)],1):e._e()],1),e._v(" "),t("div",{staticClass:"bottom-handler-tool"},[t("div",{staticClass:"btn-area"},[t("el-button",{attrs:{type:"primary",disabled:!e.tradeRuleShow},on:{click:e.saveCinemaParams}},[e._v("保存")]),e._v(" "),t("el-button",{on:{click:e.cancel}},[e._v("取消")])],1)]),e._v(" "),t("fixStepTool",{attrs:{stepData:e.stepData.stepList}})],1)},r=[],l={render:n,staticRenderFns:r};a.a=l},79:function(e,a,t){"use strict";function n(e){t(323)}Object.defineProperty(a,"__esModule",{value:!0});var r=t(201),l=t(325),o=t(4),s=n,i=o(r.a,l.a,!1,s,null,null);a.default=i.exports},85:function(e,a,t){var n=t(13);e.exports=function(e){return Object(n(e))}},86:function(e,a,t){e.exports={default:t(89),__esModule:!0}},88:function(e,a){a.f={}.propertyIsEnumerable},89:function(e,a,t){t(90),e.exports=t(1).Object.assign},90:function(e,a,t){var n=t(12);n(n.S+n.F,"Object",{assign:t(91)})},91:function(e,a,t){"use strict";var n=t(0),r=t(14),l=t(92),o=t(88),s=t(85),i=t(15),d=Object.assign;e.exports=!d||t(5)(function(){var e={},a={},t=Symbol(),n="abcdefghijklmnopqrst";return e[t]=7,n.split("").forEach(function(e){a[e]=e}),7!=d({},e)[t]||Object.keys(d({},a)).join("")!=n})?function(e,a){for(var t=s(e),d=arguments.length,m=1,u=l.f,c=o.f;d>m;)for(var p,h=i(arguments[m++]),F=u?r(h).concat(u(h)):r(h),f=F.length,v=0;f>v;)p=F[v++],n&&!c.call(h,p)||(t[p]=h[p]);return t}:d},92:function(e,a){a.f=Object.getOwnPropertySymbols}});