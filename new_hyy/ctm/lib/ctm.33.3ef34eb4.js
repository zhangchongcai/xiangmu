webpackJsonpctm([33],{182:function(e,t,i){"use strict";function n(e){i(553)}Object.defineProperty(t,"__esModule",{value:!0});var a=i(368),o=i(555),l=i(3),s=n,r=l(a.a,o.a,!1,s,null,null);t.default=r.exports},240:function(e,t,i){e.exports={default:i(241),__esModule:!0}},241:function(e,t,i){i(242);var n=i(2).Object;e.exports=function(e,t,i){return n.defineProperty(e,t,i)}},242:function(e,t,i){var n=i(6);n(n.S+n.F*!i(4),"Object",{defineProperty:i(7).f})},243:function(e,t,i){"use strict";t.__esModule=!0;var n=i(240),a=function(e){return e&&e.__esModule?e:{default:e}}(n);t.default=function(e,t,i){return t in e?(0,a.default)(e,t,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[t]=i,e}},368:function(e,t,i){"use strict";var n=i(41),a=i.n(n),o=i(77),l=i.n(o),s=i(243),r=i.n(s),c=i(37),m=i.n(c),u=i(38);t.a={data:function(){return{isEditMode:!1,planUid:"",referer:"",movieData:{},copyIntervalMin:0,curPlanDate:"",nextPlanDate:"",year:"",month:"",day:"",planHour:"",planMinute:"",copyMinute:"",showPlanDate:"",activeTab:"first",movieTable:[],timeInterval:null,hallData:null,addMovieDialog:!1,searchMovieName:"",addMovieTable:[],multipleSelection:[],planData:{},checkAll:!1,checkedChannel:[],isIndeterminate:!0,ticketData:[],channelData:[],ticketMulData:[],channelMulData:[],permitSaleBox:"",permitDiscount:"",mustRightSeat:"",mulCheckedData:[],fixedWidth:""}},mounted:function(){this.fixedWidth=document.querySelector(".content-wrapper").offsetWidth,this.dataInit()},methods:{dataInit:function(){this.isEditMode=!!this.$route.query.mode&&"edit"==this.$route.query.mode,this.planUid=this.$route.query.uid?this.$route.query.uid:"",this.referer=this.$route.query.referer?decodeURIComponent(this.$route.query.referer):"",this.getPlanData()},timeChange:function(e){var t=this;if(!this.timeInterval)return this.planMinute=this.copyMinute,this.error("暂未获取到排片时间间隔,请稍后再试");if(!this.hallData)return this.planMinute=this.copyMinute,this.error("暂未获取到当前影厅排片数据,请稍后再试");if(e<0||e>=60||!/^\+?[0-9][0-9]*$/.test(e))return this.planMinute=this.copyMinute,this.error("必须为0-59之间的整数");this.movieData.timeLong=this.movieTable.reduce(function(e,t){return e+=t.timeLong},0)+(this.movieTable.length-1)*this.movieData.intervalMinute;var i=new Date(this.year+"-"+this.month+"-"+this.day+" "+this.planHour+":"+e).getTime(),n=i+60*this.movieData.timeLong*1e3;return this.hallData.some(function(e){return i<new Date(e.showTimeEnd).getTime()+60*t.timeInterval*1e3&&n>new Date(e.showTimeEnd).getTime()||n>new Date(e.showTimeStart).getTime()-60*t.timeInterval*1e3&&i<new Date(e.showTimeStart).getTime()})?(this.planMinute=this.copyMinute,this.error("放映时间区间无法容纳该放映计划，请重新设置放映时间!")):this.curPlanDate!=this.formatDateTime(n,1)&&n>new Date(this.formatDateTime(this.nextPlanDate+" 06:00",0)).getTime()?(this.planMinute=this.copyMinute,this.error("放映结束时间不能超过次日早上6点!")):(this.movieData.planTime=this.formatDateTime(i,0),this.movieData.planTimeEnd=this.formatDateTime(n,0),this.planMinute=e<10?"0"+e:""+e,this.copyMinute=this.planMinute,void this.changeMovieTime(JSON.parse(m()(this.movieTable))))},timeIntervalChange:function(e){if(e<1||e>99||!/^\+?[1-9][0-9]*$/.test(e))return this.movieData.intervalMinute=this.copyIntervalMin,this.error("必须为0-99之间的整数");this.changeMovieTime(JSON.parse(m()(this.movieTable)))},getTimeLine:function(){var e=this;Object(u.W)({uidCinema:this.movieData.cinemaUid}).then(function(t){if(200!=t.code)return e.error(t.msg);200==t.code&&t.data&&(e.timeInterval=t.data.timeInterval)})},getPlanList:function(){var e=this;Object(u.d)({planDate:this.year+"-"+this.month+"-"+this.day,cinemaUid:this.movieData.cinemaUid}).then(function(t){if(200!=t.code)return e.error(t.msg);t.data.filter(function(t){return t.hallUid==e.movieData.hallUid&&t.planUid!=e.planUid}).forEach(function(t){t.showTimeStart=t.startTime.split(":")[0]<6?e.nextPlanDate+" "+t.startTime:e.curPlanDate+" "+t.startTime,t.showTimeEnd=t.endTime.split(":")[0]<6?e.nextPlanDate+" "+t.endTime:e.curPlanDate+" "+t.endTime}),e.hallData=t.data.filter(function(t){return t.hallUid==e.movieData.hallUid&&t.planUid!=e.planUid})})},showAddFilmDialog:function(){this.addMovieDialog=!0,this.getMovieData()},getMovieData:function(){var e=this;Object(u.E)({targetDate:this.movieData.planDate,cinemaUid:this.movieData.cinemaUid,current:1,size:100,movieName:this.searchMovieName}).then(function(t){if(200!=t.code)return e.error(t.msg);e.addMovieTable=t.data})},handleSelectionChange:function(e){this.multipleSelection=e},ticketSelChange:function(e){this.ticketData.forEach(function(t){t.switchStatus=!e.every(function(e){return e.uid!=t.uid})}),this.ticketMulData=e},channelSelChange:function(e){this.channelData.forEach(function(t){t.switchStatus=!e.every(function(e){return e.uid!=t.uid})});var t=this.movieData.isCounter&&this.movieData.isSelfServiceTerminals?2:this.movieData.isCounter||this.movieData.isSelfServiceTerminals?1:0;this.checkAll=e.length+t===this.mulCheckedData.length,this.isIndeterminate=!!(e.length+t)&&e.length+t<this.mulCheckedData.length,this.channelMulData=this.movieData.isCounter&&this.movieData.isSelfServiceTerminals?["000000","111111"].concat(e.map(function(e){return e.uid})):this.movieData.isCounter?["000000"].concat(e.map(function(e){return e.uid})):["111111"].concat(e.map(function(e){return e.uid}))},addMovieData:function(){var e=this;if(this.multipleSelection.length+this.movieTable.length>9)return this.warning("连场放映最多添加9部影片, 现在最多还可以再添加"+(9-this.movieTable.length)+"部影片!");var t=JSON.parse(m()(this.multipleSelection));t.forEach(function(i,n){i.showIndex=e.movieTable.length+n+1,i.startTimeC=n?e.formatDateTime(new Date(t[n-1].endTimeC)+60*e.movieData.intervalMinute*1e3,0):e.movieTable.length?e.formatDateTime(new Date(e.movieTable[e.movieTable.length-1].endTimeC)+60*e.movieData.intervalMinute*1e3,0):e.movieData.planTime,i.startTime=i.startTime=e.formatDateTime(new Date(i.startTimeC),2),i.endTimeC=e.formatDateTime(new Date(i.startTimeC)+60*i.timeLong*1e3,0),i.endTime=e.formatDateTime(new Date(i.startTimeC)+60*i.timeLong*1e3,2),i.minPrice=i.minPrice?parseFloat(i.minPrice).toFixed(2):"0.00",i.percentPrice=i.percentPrice?parseFloat(i.percentPrice).toFixed(2):"0.00",i.publisherRate=i.rate?parseFloat(i.rate).toFixed(2):"0.00",i.movieLanguage=i.moviedesclanguage});var i=t.map(function(e){var t,i=e.dateShowFirst,n=e.dateShowOff,a=e.minPrice,o=e.disVersion,l=e.movieCode,s=e.movieLanguage,c=e.percentPrice,m=e.publisherRate,u=e.showIndex,p=e.movieName,d=e.timeLong,h=e.startTimeC,v=e.startTime,f=e.endTimeC,b=e.endTime,A=e.planInfoMovieTimeVoList;e.uid;return t={dateShowFirst:i,dateShowOff:n,minPrice:a,disVersion:o,movieCode:l,movieLanguage:s,movieUid:e.uid,percentPrice:c,publisherRate:m,showIndex:u,movieName:p,timeLong:d,startTimeC:h,startTime:v,endTimeC:f,endTime:b},r()(t,"movieLanguage",s),r()(t,"planInfoMovieTimeVoList",A),t});this.movieTable=this.movieTable.concat(i),this.changeMovieTime(this.movieTable),this.addMovieDialog=!1,this.closeDialogCb()},closeDialogCb:function(){this.searchMovieName="",this.addMovieTable=[],this.multipleSelection=[]},deleteIndex:function(e){var t=JSON.parse(m()(this.movieTable)).filter(function(t,i){return e!=i});this.changeMovieTime(t)},changeIndex:function(e,t){var i=JSON.parse(m()(this.movieTable)),n="top"==e?t-1:t+1;i[t]=this.movieTable[n],i[n]=this.movieTable[t],this.changeMovieTime(i)},changeMovieTime:function(e){var t=this;e.forEach(function(i,n){i.showIndex=n+1,n?(i.startTimeC=t.formatDateTime(new Date(e[n-1].endTimeC).getTime()+60*t.movieData.intervalMinute*1e3,0),i.startTime=t.formatDateTime(new Date(e[n-1].endTimeC).getTime()+60*t.movieData.intervalMinute*1e3,2)):(i.startTimeC=t.movieData.planTime,i.startTime=t.formatDateTime(new Date(i.startTimeC).getTime(),2)),i.endTimeC=t.formatDateTime(new Date(i.startTimeC).getTime()+60*i.timeLong*1e3,0),i.endTime=t.formatDateTime(new Date(i.startTimeC).getTime()+60*i.timeLong*1e3,2)}),this.movieTable=e,this.movieData.planTimeEnd=e.length?e[e.length-1].endTimeC:this.movieData.planTime},getPlanData:function(){var e=this;Object(u.S)({id:this.planUid}).then(function(t){if(200!=t.code)return e.error(t.msg);var i=t.data,n=i.approveStatus,a=i.cinemaUid,o=i.hallName,l=i.hallTypeCode,s=i.hallUid,r=i.joinFlag,c=i.joinMovieName,u=i.mustRightSeat,p=i.permitDiscount,d=i.permitSaleBox,h=i.intervalMinute,v=i.planTime,f=i.planTimeEnd,b=i.priceProgramName,A=i.priceProgramUid,g=i.timeLong,C=i.isCounter,x=i.isSelfServiceTerminals,D=i.soldSeatCount,T=i.saleStatus,_=v.split(" ")[0];e.year=v.includes("T")?v.split("T")[0].split("-")[0]:v.split(" ")[0].split("-")[0],e.month=v.includes("T")?v.split("T")[0].split("-")[1]:v.split(" ")[0].split("-")[1],e.day=v.includes("T")?v.split("T")[0].split("-")[2]:v.split(" ")[0].split("-")[2],e.planHour=v.includes("T")?v.split("T")[1].split(":")[0]:v.split(" ")[1].split(":")[0],e.curPlanDate=e.planHour<6?e.formatDateTime(new Date(v).getTime()-864e5,1):e.formatDateTime(new Date(v).getTime(),1),e.nextPlanDate=e.formatDateTime(new Date(e.curPlanDate).getTime()+864e5,1),e.planMinute=v.includes("T")?v.split("T")[1].split(":")[1]:v.split(" ")[1].split(":")[1],e.copyMinute=e.planMinute,e.showPlanDate=e.isEditMode?e.year+"年"+e.month+"月"+e.day+"日"+e.planHour+"时":e.year+"年"+e.month+"月"+e.day+"日"+e.planHour+"时"+e.planMinute+"分",e.permitSaleBox=!!d,e.permitDiscount=!!p,e.mustRightSeat=!!u,e.movieData={approveStatus:n,cinemaUid:a,hallName:o,hallTypeCode:l,hallUid:s,joinFlag:r,joinMovieName:c,mustRightSeat:u,permitDiscount:p,permitSaleBox:d,intervalMinute:h,planTime:v,planTimeEnd:f,priceProgramName:b,priceProgramUid:A,timeLong:g,planDate:_,isCounter:C,isSelfServiceTerminals:x,soldSeatCount:D,saleStatus:T},e.copyIntervalMin=e.movieData.intervalMinute,e.getTimeLine(),e.getPlanList();var w=JSON.parse(m()(t.data.detailVos));w.forEach(function(t,i){t.startTimeC=i?e.formatDateTime(new Date(w[w.length-1].endTimeC)+60*e.movieData.intervalMinute*1e3,0):e.movieData.planTime,t.startTime=t.startTime=e.formatDateTime(new Date(t.startTimeC),2),t.endTimeC=e.formatDateTime(new Date(t.startTimeC)+60*t.timeLong*1e3,0),t.endTime=e.formatDateTime(new Date(t.startTimeC)+60*t.timeLong*1e3,2)}),e.changeMovieTime(w);var B=[],y=[];t.data.ticketList.forEach(function(e){t.data.baseTicketList.every(function(t){return t.uid!=e.uidBaseClass})?y.push(e):B.push(e)}),y.forEach(function(e){e.baseFlag=1,e.switchStatus="SALE"==e.saleStatus});var M=JSON.parse(m()(t.data.baseTicketList)).concat(y);M.forEach(function(e){B.some(function(t){if(t.uidBaseClass==e.uid)return e.price=t.price,e.addFee=t.addFee,e.switchStatus="SALE"==t.saleStatus,!0}),e.addFee||(e.addFee=0),e.price||(e.price=0),e.addFee=parseFloat(e.addFee).toFixed(2),e.price=parseFloat(e.price).toFixed(2),e.name||(e.name=e.ticketName),e.switchStatus||(e.switchStatus=0==e.baseFlag),e.saveUid=e.uid?e.uid:e.uidBaseClass}),e.isEditMode||(M=M.filter(function(e){return 0!=e.price})),e.ticketData=M;var S=[],k=[];t.data.channelList.forEach(function(e){t.data.baseChannelList.every(function(t){return t.uid!=e.uidChannel})?k.push(e):S.push(e)});var P=JSON.parse(m()(t.data.baseChannelList)).concat(k.map(function(e){return e.switchStatus="SALE"==e.saleStatus,e}));P.forEach(function(e){S.some(function(t){if(t.uidChannel==e.uid)return e.price=t.price,e.cinemaFee=t.cinemaFee,e.feeFg=t.feeFg,e.switchStatus="SALE"==t.saleStatus,!0}),e.price||(e.price=0),e.addFee||(e.addFee=0),e.cinemaFee||(e.cinemaFee=0),e.feeFg||(e.feeFg=0),e.netSaleAddPrice||(e.netSaleAddPrice=0),e.price=parseFloat(e.price).toFixed(2),e.addFee=parseFloat(e.addFee).toFixed(2),e.netSaleAddPrice=parseFloat(e.netSaleAddPrice).toFixed(2),e.cinemaFee=parseFloat(e.cinemaFee).toFixed(2),e.name||(e.name=e.channelName),e.switchStatus||(e.switchStatus=!1),e.saveUid=e.uidChannel?e.uidChannel:e.uid}),e.isEditMode||(P=P.filter(function(e){return 0!=e.price})),e.channelData=P,e.mulCheckedData=[{uid:"000000",name:"柜台"},{uid:"111111",name:"自助终端"}].concat(e.channelData.map(function(e){return{uid:e.uid,name:e.name}})),e.movieData.isCounter&&(e.channelMulData=e.channelMulData.concat(["000000"])),e.movieData.isSelfServiceTerminals&&(e.channelMulData=e.channelMulData.concat(["111111"])),e.$nextTick(function(){e.ticketData.filter(function(e){return e.switchStatus}).forEach(function(t){e.$refs.ticketMultipleTable.toggleRowSelection(t,!0)}),e.channelData.filter(function(e){return e.switchStatus}).forEach(function(t){e.$refs.channelMultipleTable.toggleRowSelection(t,!0)})}),e.isIndeterminate=e.channelMulData.length>0&&e.channelMulData.length<e.mulCheckedData.length,e.checkAll=e.channelMulData.length==e.mulCheckedData.length})},handleCheckAllChange:function(e){var t=this;this.channelMulData=e?this.mulCheckedData:[],this.$refs.channelMultipleTable.clearSelection(),this.channelData.reduce(function(e,i){return t.channelData.some(function(e){return!t.channelMulData.every(function(t){return t.uid!=e.uid})})?e.concat(i):e},[]).forEach(function(e){t.$refs.channelMultipleTable.toggleRowSelection(e)}),this.isIndeterminate=!1},handleCheckedChannelChange:function(e){var t=e.length;this.checkAll=t===this.mulCheckedData.length,this.isIndeterminate=t>0&&t<this.mulCheckedData.length,this.movieData.isCounter=e.some(function(e){return"000000"==e}),this.movieData.isSelfServiceTerminals=e.some(function(e){return"111111"==e})},singleCheckChange:function(e){var t=this.channelData.find(function(t){return e==t.uid});t&&this.$refs.channelMultipleTable.toggleRowSelection(t)},tableFixed:function(e){var t=this.ticketData[e.$index].price,i=this.ticketData[e.$index].addFee;this.ticketData[e.$index].price=Number(t).toFixed(2),this.ticketData[e.$index].addFee=Number(i).toFixed(2)},cichannelToFixed:function(e){var t=this.channelData[e.$index].price,i=this.channelData[e.$index].addFee,n=this.channelData[e.$index].netSaleAddPrice;this.channelData[e.$index].price=Number(t).toFixed(2),this.channelData[e.$index].addFee=Number(i).toFixed(2),this.channelData[e.$index].netSaleAddPrice=Number(n).toFixed(2)},percentTableToFixed:function(e){var t=this.movieTable[e.$index].percentPrice,i=this.movieTable[e.$index].minPrice,n=this.movieTable[e.$index].publisherRate;this.movieTable[e.$index].percentPrice=Number(t).toFixed(2),this.movieTable[e.$index].minPrice=Number(i).toFixed(2),this.movieTable[e.$index].publisherRate=Number(n).toFixed(2)},savePlan:function(){var e=this,t=new l.a(function(t,i){var n=!e.movieData.joinMovieName,a=e.movieData.intervalMinute<1||e.movieData.intervalMinute>99||!/^\+?[1-9][0-9]*$/.test(e.movieData.intervalMinute),o=void 0;o=e.movieTable.length<2?"连场最少设置两部影片":e.movieTable.length>9&&"连场影片不得超过9部";var l=void 0;e.movieData.timeLong=e.movieTable.reduce(function(e,t){return e+=t.timeLong},0)+(e.movieTable.length-1)*e.movieData.intervalMinute;var s=new Date(e.year+"-"+e.month+"-"+e.day+" "+e.planHour+":"+e.planMinute).getTime(),r=s+60*e.movieData.timeLong*1e3;e.hallData.some(function(t){return s<new Date(t.showTimeEnd).getTime()+60*e.timeInterval*1e3&&r>new Date(t.showTimeEnd).getTime()||r>new Date(t.showTimeStart).getTime()+60*e.timeInterval*1e3&&s<new Date(t.showTimeStart).getTime()})&&(l="放映时间区间无法容纳该放映计划，请重新设置放映时间!"),e.curPlanDate!=e.formatDateTime(r,1)&&r>new Date(e.formatDateTime(e.nextPlanDate+" 06:00",0)).getTime()&&(l="放映结束时间不能超过次日早上6点!"),n||o||a||l?n?i("请输入正确的连场名称"):o?i(o):a?i("场次间隔栏请输入一个介于1和99之间的整数"):l&&i(l):t()}),i=new l.a(function(t,i){var n=[];e.movieTable.forEach(function(e){(new Date(e.startTimeC).getTime()>=new Date(e.dateShowOff).getTime()||new Date(e.startTimeC).getTime()<new Date(e.dateShowFirst).getTime())&&n.push(e)});var a=n.map(function(e){return e.movieName});a.length?a&&i("电影"+a.join(",")+"的放映时间不在上下映时间范围内, 请修改!"):t()}),n=new l.a(function(t,i){var n=e.checkTimeInfoRight();n.planError?n.planError&&i(n.errorType):t()}),a=new l.a(function(t,i){var n=e.movieTable.find(function(e){return e.minPrice>999.99||e.minPrice<=0||!/^(([1-9][0-9]*)|(([0]\.\d{1,2}|[1-9][0-9]*\.\d{1,2})))$/.test(e.minPrice)});n?n&&i("电影"+n.movieName+"的最低票价必须大于0小于1000的数字，且小数位不能超过2位!"):t()}),o=new l.a(function(t,i){var n=e.movieTable.find(function(e){return e.publisherRate>100||e.publisherRate<0||!/^(([1-9][0-9]*)|(([0]\.\d{1,2}|[1-9][0-9]*\.\d{1,2})))$/.test(e.publisherRate)});n?n&&i("电影"+n.movieName+"的分账比例输入范围为0-100,允许2位小数!"):t()}),s=new l.a(function(t,i){var n=100!=e.movieTable.reduce(function(e,t){return e+=Number(t.percentPrice)},0);n?n&&i("所有连场的影片分摊比例之和必须为100"):t()}),r=new l.a(function(t,i){var n=e.ticketData.filter(function(e){return e.switchStatus}).find(function(e){return e.price>999.99||e.price<=0});n?n&&i("票类"+n.name+"的票价必须大于0小于1000的数字，且小数位不能超过2位!"):t()}),c=new l.a(function(t,i){var n=e.channelData.filter(function(e){return e.switchStatus}).find(function(e){return Number(e.price)>999.99||e.price<=0});n?n&&i("渠道"+n.name+"的票价必须大于0小于1000的数字，且小数位不能超过2位!"):t()}),m=new l.a(function(t,i){var n=e.ticketData.filter(function(e){return e.switchStatus}).sort(function(e,t){return e.price-t.price}),a=n.length?e.movieTable.find(function(e){return e.percentPrice*n[0].price/100<e.minPrice}):"";a?a&&i("电影"+a.movieName+"在票类"+n[0].name+"的票价小于最低票价，请修改票价分摊比例"):t()}),u=new l.a(function(t,i){var n=e.channelData.filter(function(e){return e.switchStatus}).sort(function(e,t){return e.price-t.price}),a=n.length?e.movieTable.find(function(e){return e.percentPrice*n[0].price/100<e.minPrice}):"";a?a&&i("电影"+a.movieName+"在渠道"+n[0].name+"的票价小于最低票价，请修改票价分摊比例"):t()});l.a.all([t,i,n,a,o,s,r,c,m,u]).then(function(){e.submitPlan()}).catch(function(t){console.log(t),e.error(t)})},submitPlan:function(){var e=this,t=this.movieData,i=t.cinemaUid,n=t.hallUid,o=t.joinFlag,l=t.planTimeEnd,s=t.intervalMinute,r=t.isCounter,c=t.isSelfServiceTerminals,m=this.year+"-"+this.month+"-"+this.day,p=this.movieData.planTime,d=this.permitSaleBox?1:0,h=this.mustRightSeat?1:0,v=this.permitDiscount?1:0,f=this.planUid,b=this.movieData.priceProgramName,A=this.movieData.priceProgramUid,g=this.movieData.joinMovieName,C=this.movieTable[0].movieCode,x=this.movieTable[0].minPrice,D=this.movieTable[0].rate,T=this.movieTable[0].movieLanguage,_=this.ticketData.filter(function(e){return e.price>0}).map(function(e){return{addFee:e.addFee,baseFlag:e.baseFlag,price:e.price,ticketName:e.name,uidBaseClass:e.saveUid,saleStatus:e.switchStatus?"SALE":"NOT_SALE"}}),w=this.channelData.filter(function(e){return e.price>0}).map(function(e){return{addFee:e.addFee,channelName:e.name,cinemaFee:e.cinemaFee,feeFg:0,price:e.price,uidChannel:e.saveUid,saleStatus:e.switchStatus?"SALE":"NOT_SALE"}}),B=this.movieTable.map(function(e){return{minPrice:e.minPrice,movieCode:e.movieCode,percentPrice:e.percentPrice,rate:e.publisherRate,showIndex:e.showIndex,movieDescLanguage:e.movieLanguage,planTimeStart:e.startTimeC,planTimeEnd:e.endTimeC}}),y={cinemaUid:i,hallUid:n,joinFlag:o,mustRightSeat:h,permitDiscount:v,joinMovieName:g,permitSaleBox:d,planUid:f,priceProgramName:b,priceProgramUid:A,planTimeEnd:l,planDate:m,planTimeStart:p,schPlanBaseTicketVoList:_,schPlanFavTicketVoList:w,planTimeVoList:B,movieCode:C,minPrice:x,rate:D,movieLanguage:T,intervalMinute:s,isCounter:r?1:0,isSelfServiceTerminals:c?1:0};Object(u._19)({list:"STOP"==this.movieData.saleStatus?[a()(y,{isNeedApprove:1})]:[a()(y,{isNeedApprove:0})]}).then(function(t){if(200!=t.code)return e.error(t.msg);if(200==t.code&&t.data){if(t.data.length)return e.warning("保存不成功, 请修改价格方案");e.success("保存成功, 即将跳转至排片详情"),setTimeout(function(){e.$store.commit("tagNav/removeTagNav",{name:e.$route.name,path:e.$route.path,title:e.$route.meta.title,query:e.$route.query}),e.referer?e.$router.push({path:e.referer}):e.$router.push({path:"layout",query:{date:e.curPlanDate}})},1e3)}})},cancelHandle:function(){this.$store.commit("tagNav/removeTagNav",{name:this.$route.name,path:this.$route.path,title:this.$route.meta.title,query:this.$route.query}),this.referer?this.$router.push({path:this.referer}):this.$router.push({path:"layout",query:{date:this.curPlanDate}})},closePage:function(){this.$store.commit("tagNav/removeTagNav",{name:this.$route.name,path:this.$route.path,title:this.$route.meta.title,query:this.$route.query}),this.referer?this.$router.push({path:this.referer}):this.$router.push({path:"layout",query:{date:this.curPlanDate}})},formatDateTime:function(e,t){var i=new Date(e),n=i.getFullYear(),a=i.getMonth()+1;a=a<10?"0"+a:a;var o=i.getDate();o=o<10?"0"+o:o;var l=i.getHours();l=l<10?"0"+l:l;var s=i.getMinutes();return s=s<10?"0"+s:s,0==t?n+"-"+a+"-"+o+" "+l+":"+s:1==t?n+"-"+a+"-"+o:2==t?l+":"+s:n+"-"+a+"-"+o+" "+l+":"+s},rowIsDisabled:function(e){return e.baseFlag},checkTimeRight:function(){var e=[];return this.movieTable.forEach(function(t){(new Date(t.startTimeC).getTime()>=new Date(t.dateShowOff).getTime()||new Date(t.startTimeC).getTime()<new Date(t.dateShowFirst).getTime())&&e.push(t)}),{planError:e.length,errorType:"影片"+e.map(function(e){return e.movieName}).join(",")+"的开场时间不在上下映范围内, 不能编排放映计划"}},checkTimeInfoRight:function(){var e=this,t=[];return this.movieTable.forEach(function(i){if(i.planInfoMovieTimeVoList.length){var n=e.formatDateTime(new Date(i.startTimeC).getTime(),1);i.planInfoMovieTimeVoList.some(function(e){return i.startDate&&i.endDate&&i.endTime&&i.startTime?new Date(n).getTime()>=new Date(""+e.startDate).getTime()&&new Date(n).getTime()<=new Date(e.endDate).getTime()&&new Date(""+i.planTimeStart).getTime()>=new Date(n+" "+e.startTime).getTime()&&new Date(""+i.planTimeStart).getTime()<=new Date(n+" "+e.endTime).getTime():!e.startDate||!e.endDate||e.endTime&&e.startTime?!(!(e.startDate&&e.endDate||!e.endTime)&&e.startTime)||new Date(""+i.planTimeStart).getTime()>=new Date(n+" "+e.startTime).getTime()&&new Date(""+i.planTimeStart).getTime()<=new Date(n+" "+e.endTime).getTime():new Date(n).getTime()>=new Date(""+e.startDate).getTime()&&new Date(n).getTime()<=new Date(e.endDate).getTime()})||t.push(i)}}),{planError:t.length,errorType:"影片"+t.map(function(e){return e.movieName}).join(",")+"的开场时间不在影片允许的排片时间内, 不能编排放映计划"}}},computed:{approveStatus:function(){return"NOT_APPROVE"==this.movieData.approveStatus?"未审核":"WAIT_APPROVE"==this.movieData.approveStatus?"待审核":"REJECT"==this.movieData.approveStatus?"已驳回":"已审核"}}}},553:function(e,t,i){var n=i(554);"string"==typeof n&&(n=[[e.i,n,""]]),n.locals&&(e.exports=n.locals);i(157)("0ebfa5e5",n,!0,{})},554:function(e,t,i){t=e.exports=i(156)(!0),t.push([e.i,"\n.movie-plan-continuity {\n  padding-bottom: 64px;\n}\n.movie-plan-continuity .basic-info {\n    margin-left: 30px;\n    margin-bottom: 30px;\n}\n.movie-plan-continuity .basic-info .base-info-title {\n      margin-bottom: 16px;\n      font-size: 14px;\n      color: #333;\n}\n.movie-plan-continuity .basic-info .el-form-item {\n      margin-bottom: 14px;\n}\n.movie-plan-continuity .basic-info .el-form-item__label {\n      font-size: 12px;\n      text-align: left;\n}\n.movie-plan-continuity .basic-info .el-select,\n    .movie-plan-continuity .basic-info .el-textarea,\n    .movie-plan-continuity .basic-info .el-input__inner {\n      width: 360px;\n}\n.movie-plan-continuity .basic-info .cinema-stock-edit-text {\n      font-size: 12px;\n      color: #666;\n}\n.movie-plan-continuity .basic-info .separate-accounts-date,\n    .movie-plan-continuity .basic-info .separate-accounts-price,\n    .movie-plan-continuity .basic-info .separate-accounts-action {\n      display: inline-block;\n}\n.movie-plan-continuity .basic-info .canal-pirce-input .el-input {\n      width: 48px;\n      height: 20px;\n}\n.movie-plan-continuity .basic-info .canal-pirce-input .el-input .el-input__inner {\n        width: 100%;\n        height: 100%;\n        -webkit-box-sizing: border-box;\n                box-sizing: border-box;\n        padding: 0 0 0 10px;\n}\n.movie-plan-continuity .basic-info .el-form-item__content {\n      font-size: 12px;\n      color: #666;\n}\n.movie-plan-continuity .basic-info.movie-info .el-form {\n      width: 1000px;\n      overflow: hidden;\n}\n.movie-plan-continuity .basic-info.movie-info .short-input {\n      width: 40px;\n      font-size: 12px;\n      color: #666;\n}\n.movie-plan-continuity .basic-info.movie-info .short-input .el-input__inner {\n        width: 40px;\n        padding: 0 5px;\n        height: 20px;\n        line-height: 20px;\n}\n.movie-plan-continuity .basic-info.movie-info .normal-input {\n      width: 152px;\n      font-size: 12px;\n      color: #666;\n}\n.movie-plan-continuity .basic-info.movie-info .normal-input .el-input__inner {\n        width: 152px;\n        padding: 0 5px;\n        height: 32px;\n        line-height: 32px;\n        font-size: 12px;\n}\n.movie-plan-continuity .basic-info.movie-info .movie-lang .el-select {\n      position: relative;\n      top: -2px;\n      width: 200px;\n      height: 30px;\n}\n.movie-plan-continuity .basic-info.movie-info .movie-lang .el-select .el-input__inner {\n        width: 200px;\n        height: 30px;\n}\n.movie-plan-continuity .basic-info.movie-info .movie-lang .el-select .el-input {\n        width: 200px;\n        height: 30px;\n        line-height: 30px;\n}\n.movie-plan-continuity .basic-info.movie-info .el-form-item {\n      height: 34px;\n}\n.movie-plan-continuity .basic-info.movie-info .el-date-editor {\n      width: 120px;\n}\n.movie-plan-continuity .basic-info.movie-info .el-date-editor .el-input__inner {\n        width: 120px;\n}\n.movie-plan-continuity .basic-info .table-rule {\n      color: #3f3f3f;\n      font-size: 12px;\n      height: 20px;\n      line-height: 20px;\n}\n.movie-plan-continuity .basic-info .table-bottom-menu {\n      width: 360px;\n      position: relative;\n      margin-top: 10px;\n}\n.movie-plan-continuity .basic-info .prcie-promise {\n      font-size: 12px;\n      margin-bottom: 8px;\n      color: #666;\n      height: 20px;\n      line-height: 20px;\n}\n.movie-plan-continuity .basic-info .prcie-promise span {\n        font-size: 12px;\n}\n.movie-plan-continuity .basic-info .el-tabs__header.is-top {\n      border-bottom: none;\n}\n.movie-plan-continuity .basic-info .el-tabs--card > .el-tabs__header .el-tabs__nav {\n      border: 1px solid #3b74ff;\n      border-radius: 4px;\n}\n.movie-plan-continuity .basic-info .el-tabs--card > .el-tabs__header .el-tabs__nav .el-tabs__item {\n        -webkit-transition: none;\n        transition: none;\n        min-width: 80px;\n        -webkit-box-sizing: border-box;\n                box-sizing: border-box;\n        padding: 0 16px;\n        height: 32px;\n        line-height: 32px;\n        font-size: 12px;\n        vertical-align: middle;\n        color: #3b74ff;\n        text-align: center;\n}\n.movie-plan-continuity .basic-info .el-tabs--card > .el-tabs__header .el-tabs__nav .el-tabs__item.is-active {\n          background-color: #3b74ff;\n          border-color: #3b74ff;\n          color: #fff;\n}\n.movie-plan-continuity .basic-info .el-table {\n      max-width: 1200px;\n}\n.movie-plan-continuity .basic-info .el-table .input-con {\n        position: relative;\n        display: inline-block;\n        font-size: 12px;\n}\n.movie-plan-continuity .basic-info .el-table .input-con .rmb-hover {\n          position: absolute;\n          left: 10px;\n          top: 2px;\n          font-size: 12px;\n          font-style: normal;\n}\n.movie-plan-continuity .basic-info .el-table .input-con .el-input__inner {\n          width: 150px;\n          height: 20px;\n          padding-left: 20px;\n          padding-right: 0px;\n}\n.movie-plan-continuity .basic-info .el-table .input-con .el-input {\n          width: 80px;\n          height: 20px;\n          line-height: 20px;\n          font-size: 12px;\n}\n.movie-plan-continuity .bottom-handler-tool {\n    height: 64px;\n    position: fixed;\n    z-index: 999;\n    bottom: 0;\n    right: 0;\n    background-color: #f5f5f5;\n}\n.movie-plan-continuity .bottom-handler-tool .btn-area {\n      width: 500px;\n      margin: 0 auto;\n      height: 64px;\n      text-align: center;\n      padding-top: 16px;\n      -webkit-box-sizing: border-box;\n              box-sizing: border-box;\n}\n.add-movie-dialog .el-form-item .search-wrap {\n  display: inline-block;\n  margin-right: 10px;\n}\n.add-movie-dialog .el-form-item .search-wrap span {\n    color: #666;\n    font-size: 12px;\n}\n.add-movie-dialog .el-form-item .el-input {\n  width: 120px;\n  height: 32px;\n}\n.add-movie-dialog .el-form-item .el-input .el-input__inner {\n    width: 100%;\n    height: 100%;\n    -webkit-box-sizing: border-box;\n            box-sizing: border-box;\n    padding: 0 0 0 10px;\n}\n.add-movie-dialog .el-form-item .el-select {\n  margin-right: 10px;\n  width: 120px;\n  height: 32px;\n}\n.add-movie-dialog .el-form-item .el-select .el-input__suffix {\n    right: 0;\n}\n.add-movie-dialog .el-form-item .el-select .el-select__caret {\n    font-size: 12px;\n}\n.add-movie-dialog .el-form-item .el-select .el-input__inner {\n    width: 120px;\n    height: 32px;\n    padding-right: 32px;\n}\n.add-movie-dialog .el-form-item .el-select .el-input {\n    width: 120px;\n    height: 20px;\n    line-height: 20px;\n    font-size: 12px;\n}\n.add-movie-dialog .el-form-item .el-select .el-input__icon {\n    line-height: 20px;\n}\n","",{version:3,sources:["G:/Workspaces/work/chenxin/module-hyy/ctm/src/views/moviePlan/planEdit/consecutivePlan.vue"],names:[],mappings:";AACA;EACE,qBAAqB;CACtB;AACD;IACI,kBAAkB;IAClB,oBAAoB;CACvB;AACD;MACM,oBAAoB;MACpB,gBAAgB;MAChB,YAAY;CACjB;AACD;MACM,oBAAoB;CACzB;AACD;MACM,gBAAgB;MAChB,iBAAiB;CACtB;AACD;;;MAGM,aAAa;CAClB;AACD;MACM,gBAAgB;MAChB,YAAY;CACjB;AACD;;;MAGM,sBAAsB;CAC3B;AACD;MACM,YAAY;MACZ,aAAa;CAClB;AACD;QACQ,YAAY;QACZ,aAAa;QACb,+BAA+B;gBACvB,uBAAuB;QAC/B,oBAAoB;CAC3B;AACD;MACM,gBAAgB;MAChB,YAAY;CACjB;AACD;MACM,cAAc;MACd,iBAAiB;CACtB;AACD;MACM,YAAY;MACZ,gBAAgB;MAChB,YAAY;CACjB;AACD;QACQ,YAAY;QACZ,eAAe;QACf,aAAa;QACb,kBAAkB;CACzB;AACD;MACM,aAAa;MACb,gBAAgB;MAChB,YAAY;CACjB;AACD;QACQ,aAAa;QACb,eAAe;QACf,aAAa;QACb,kBAAkB;QAClB,gBAAgB;CACvB;AACD;MACM,mBAAmB;MACnB,UAAU;MACV,aAAa;MACb,aAAa;CAClB;AACD;QACQ,aAAa;QACb,aAAa;CACpB;AACD;QACQ,aAAa;QACb,aAAa;QACb,kBAAkB;CACzB;AACD;MACM,aAAa;CAClB;AACD;MACM,aAAa;CAClB;AACD;QACQ,aAAa;CACpB;AACD;MACM,eAAe;MACf,gBAAgB;MAChB,aAAa;MACb,kBAAkB;CACvB;AACD;MACM,aAAa;MACb,mBAAmB;MACnB,iBAAiB;CACtB;AACD;MACM,gBAAgB;MAChB,mBAAmB;MACnB,YAAY;MACZ,aAAa;MACb,kBAAkB;CACvB;AACD;QACQ,gBAAgB;CACvB;AACD;MACM,oBAAoB;CACzB;AACD;MACM,0BAA0B;MAC1B,mBAAmB;CACxB;AACD;QACQ,yBAAyB;QACzB,iBAAiB;QACjB,gBAAgB;QAChB,+BAA+B;gBACvB,uBAAuB;QAC/B,gBAAgB;QAChB,aAAa;QACb,kBAAkB;QAClB,gBAAgB;QAChB,uBAAuB;QACvB,eAAe;QACf,mBAAmB;CAC1B;AACD;UACU,0BAA0B;UAC1B,sBAAsB;UACtB,YAAY;CACrB;AACD;MACM,kBAAkB;CACvB;AACD;QACQ,mBAAmB;QACnB,sBAAsB;QACtB,gBAAgB;CACvB;AACD;UACU,mBAAmB;UACnB,WAAW;UACX,SAAS;UACT,gBAAgB;UAChB,mBAAmB;CAC5B;AACD;UACU,aAAa;UACb,aAAa;UACb,mBAAmB;UACnB,mBAAmB;CAC5B;AACD;UACU,YAAY;UACZ,aAAa;UACb,kBAAkB;UAClB,gBAAgB;CACzB;AACD;IACI,aAAa;IACb,gBAAgB;IAChB,aAAa;IACb,UAAU;IACV,SAAS;IACT,0BAA0B;CAC7B;AACD;MACM,aAAa;MACb,eAAe;MACf,aAAa;MACb,mBAAmB;MACnB,kBAAkB;MAClB,+BAA+B;cACvB,uBAAuB;CACpC;AACD;EACE,sBAAsB;EACtB,mBAAmB;CACpB;AACD;IACI,YAAY;IACZ,gBAAgB;CACnB;AACD;EACE,aAAa;EACb,aAAa;CACd;AACD;IACI,YAAY;IACZ,aAAa;IACb,+BAA+B;YACvB,uBAAuB;IAC/B,oBAAoB;CACvB;AACD;EACE,mBAAmB;EACnB,aAAa;EACb,aAAa;CACd;AACD;IACI,SAAS;CACZ;AACD;IACI,gBAAgB;CACnB;AACD;IACI,aAAa;IACb,aAAa;IACb,oBAAoB;CACvB;AACD;IACI,aAAa;IACb,aAAa;IACb,kBAAkB;IAClB,gBAAgB;CACnB;AACD;IACI,kBAAkB;CACrB",file:"consecutivePlan.vue",sourcesContent:["\n.movie-plan-continuity {\n  padding-bottom: 64px;\n}\n.movie-plan-continuity .basic-info {\n    margin-left: 30px;\n    margin-bottom: 30px;\n}\n.movie-plan-continuity .basic-info .base-info-title {\n      margin-bottom: 16px;\n      font-size: 14px;\n      color: #333;\n}\n.movie-plan-continuity .basic-info .el-form-item {\n      margin-bottom: 14px;\n}\n.movie-plan-continuity .basic-info .el-form-item__label {\n      font-size: 12px;\n      text-align: left;\n}\n.movie-plan-continuity .basic-info .el-select,\n    .movie-plan-continuity .basic-info .el-textarea,\n    .movie-plan-continuity .basic-info .el-input__inner {\n      width: 360px;\n}\n.movie-plan-continuity .basic-info .cinema-stock-edit-text {\n      font-size: 12px;\n      color: #666;\n}\n.movie-plan-continuity .basic-info .separate-accounts-date,\n    .movie-plan-continuity .basic-info .separate-accounts-price,\n    .movie-plan-continuity .basic-info .separate-accounts-action {\n      display: inline-block;\n}\n.movie-plan-continuity .basic-info .canal-pirce-input .el-input {\n      width: 48px;\n      height: 20px;\n}\n.movie-plan-continuity .basic-info .canal-pirce-input .el-input .el-input__inner {\n        width: 100%;\n        height: 100%;\n        -webkit-box-sizing: border-box;\n                box-sizing: border-box;\n        padding: 0 0 0 10px;\n}\n.movie-plan-continuity .basic-info .el-form-item__content {\n      font-size: 12px;\n      color: #666;\n}\n.movie-plan-continuity .basic-info.movie-info .el-form {\n      width: 1000px;\n      overflow: hidden;\n}\n.movie-plan-continuity .basic-info.movie-info .short-input {\n      width: 40px;\n      font-size: 12px;\n      color: #666;\n}\n.movie-plan-continuity .basic-info.movie-info .short-input .el-input__inner {\n        width: 40px;\n        padding: 0 5px;\n        height: 20px;\n        line-height: 20px;\n}\n.movie-plan-continuity .basic-info.movie-info .normal-input {\n      width: 152px;\n      font-size: 12px;\n      color: #666;\n}\n.movie-plan-continuity .basic-info.movie-info .normal-input .el-input__inner {\n        width: 152px;\n        padding: 0 5px;\n        height: 32px;\n        line-height: 32px;\n        font-size: 12px;\n}\n.movie-plan-continuity .basic-info.movie-info .movie-lang .el-select {\n      position: relative;\n      top: -2px;\n      width: 200px;\n      height: 30px;\n}\n.movie-plan-continuity .basic-info.movie-info .movie-lang .el-select .el-input__inner {\n        width: 200px;\n        height: 30px;\n}\n.movie-plan-continuity .basic-info.movie-info .movie-lang .el-select .el-input {\n        width: 200px;\n        height: 30px;\n        line-height: 30px;\n}\n.movie-plan-continuity .basic-info.movie-info .el-form-item {\n      height: 34px;\n}\n.movie-plan-continuity .basic-info.movie-info .el-date-editor {\n      width: 120px;\n}\n.movie-plan-continuity .basic-info.movie-info .el-date-editor .el-input__inner {\n        width: 120px;\n}\n.movie-plan-continuity .basic-info .table-rule {\n      color: #3f3f3f;\n      font-size: 12px;\n      height: 20px;\n      line-height: 20px;\n}\n.movie-plan-continuity .basic-info .table-bottom-menu {\n      width: 360px;\n      position: relative;\n      margin-top: 10px;\n}\n.movie-plan-continuity .basic-info .prcie-promise {\n      font-size: 12px;\n      margin-bottom: 8px;\n      color: #666;\n      height: 20px;\n      line-height: 20px;\n}\n.movie-plan-continuity .basic-info .prcie-promise span {\n        font-size: 12px;\n}\n.movie-plan-continuity .basic-info .el-tabs__header.is-top {\n      border-bottom: none;\n}\n.movie-plan-continuity .basic-info .el-tabs--card > .el-tabs__header .el-tabs__nav {\n      border: 1px solid #3b74ff;\n      border-radius: 4px;\n}\n.movie-plan-continuity .basic-info .el-tabs--card > .el-tabs__header .el-tabs__nav .el-tabs__item {\n        -webkit-transition: none;\n        transition: none;\n        min-width: 80px;\n        -webkit-box-sizing: border-box;\n                box-sizing: border-box;\n        padding: 0 16px;\n        height: 32px;\n        line-height: 32px;\n        font-size: 12px;\n        vertical-align: middle;\n        color: #3b74ff;\n        text-align: center;\n}\n.movie-plan-continuity .basic-info .el-tabs--card > .el-tabs__header .el-tabs__nav .el-tabs__item.is-active {\n          background-color: #3b74ff;\n          border-color: #3b74ff;\n          color: #fff;\n}\n.movie-plan-continuity .basic-info .el-table {\n      max-width: 1200px;\n}\n.movie-plan-continuity .basic-info .el-table .input-con {\n        position: relative;\n        display: inline-block;\n        font-size: 12px;\n}\n.movie-plan-continuity .basic-info .el-table .input-con .rmb-hover {\n          position: absolute;\n          left: 10px;\n          top: 2px;\n          font-size: 12px;\n          font-style: normal;\n}\n.movie-plan-continuity .basic-info .el-table .input-con .el-input__inner {\n          width: 150px;\n          height: 20px;\n          padding-left: 20px;\n          padding-right: 0px;\n}\n.movie-plan-continuity .basic-info .el-table .input-con .el-input {\n          width: 80px;\n          height: 20px;\n          line-height: 20px;\n          font-size: 12px;\n}\n.movie-plan-continuity .bottom-handler-tool {\n    height: 64px;\n    position: fixed;\n    z-index: 999;\n    bottom: 0;\n    right: 0;\n    background-color: #f5f5f5;\n}\n.movie-plan-continuity .bottom-handler-tool .btn-area {\n      width: 500px;\n      margin: 0 auto;\n      height: 64px;\n      text-align: center;\n      padding-top: 16px;\n      -webkit-box-sizing: border-box;\n              box-sizing: border-box;\n}\n.add-movie-dialog .el-form-item .search-wrap {\n  display: inline-block;\n  margin-right: 10px;\n}\n.add-movie-dialog .el-form-item .search-wrap span {\n    color: #666;\n    font-size: 12px;\n}\n.add-movie-dialog .el-form-item .el-input {\n  width: 120px;\n  height: 32px;\n}\n.add-movie-dialog .el-form-item .el-input .el-input__inner {\n    width: 100%;\n    height: 100%;\n    -webkit-box-sizing: border-box;\n            box-sizing: border-box;\n    padding: 0 0 0 10px;\n}\n.add-movie-dialog .el-form-item .el-select {\n  margin-right: 10px;\n  width: 120px;\n  height: 32px;\n}\n.add-movie-dialog .el-form-item .el-select .el-input__suffix {\n    right: 0;\n}\n.add-movie-dialog .el-form-item .el-select .el-select__caret {\n    font-size: 12px;\n}\n.add-movie-dialog .el-form-item .el-select .el-input__inner {\n    width: 120px;\n    height: 32px;\n    padding-right: 32px;\n}\n.add-movie-dialog .el-form-item .el-select .el-input {\n    width: 120px;\n    height: 20px;\n    line-height: 20px;\n    font-size: 12px;\n}\n.add-movie-dialog .el-form-item .el-select .el-input__icon {\n    line-height: 20px;\n}\n"],sourceRoot:""}])},555:function(e,t,i){"use strict";var n=function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("div",{staticClass:"movie-plan-continuity"},[e.isEditMode&&0==e.movieData.soldSeatCount?i("div",{staticClass:"basic-info movie-info"},[i("el-form",{attrs:{"label-width":"80px"}},[i("el-form-item",{attrs:{label:"影厅："}},[i("span",{staticClass:"cinema-stock-edit-text"},[e._v("\n          "+e._s(e.movieData.hallName)+"\n        ")])]),e._v(" "),i("el-form-item",{attrs:{label:"连场名称："}},[i("span",{staticClass:"cinema-stock-edit-text"},[i("el-input",{staticClass:"normal-input",attrs:{placeholder:"请输入连场名称",disabled:"STOP"==e.movieData.saleStatus},model:{value:e.movieData.joinMovieName,callback:function(t){e.$set(e.movieData,"joinMovieName",t)},expression:"movieData.joinMovieName"}})],1)]),e._v(" "),i("el-form-item",{attrs:{label:"开始时间："}},[i("span",{staticClass:"cinema-stock-edit-text"},[e._v("\n          "+e._s(e.showPlanDate)+"\n          "),i("el-input",{staticClass:"short-input",attrs:{disabled:"STOP"==e.movieData.saleStatus},on:{change:e.timeChange},model:{value:e.planMinute,callback:function(t){e.planMinute=t},expression:"planMinute"}}),e._v("\n           分\n        ")],1)]),e._v(" "),i("el-form-item",{attrs:{label:"影片间隔："}},[i("span",{staticClass:"cinema-stock-edit-text"},[i("el-input",{staticClass:"short-input",attrs:{disabled:"STOP"==e.movieData.saleStatus},on:{change:e.timeIntervalChange},model:{value:e.movieData.intervalMinute,callback:function(t){e.$set(e.movieData,"intervalMinute",t)},expression:"movieData.intervalMinute"}}),e._v("\n           分钟\n        ")],1)])],1)],1):i("div",{staticClass:"basic-info movie-info"},[i("el-form",{attrs:{"label-width":"80px"}},[i("el-form-item",{attrs:{label:"影厅："}},[i("span",{staticClass:"cinema-stock-edit-text"},[e._v("\n          "+e._s(e.movieData.hallName)+"\n        ")])]),e._v(" "),i("el-form-item",{attrs:{label:"连场名称："}},[i("span",{staticClass:"cinema-stock-edit-text"},[e._v("\n          "+e._s(e.movieData.joinMovieName)+"\n        ")])]),e._v(" "),i("el-form-item",{attrs:{label:"开始时间："}},[i("span",{staticClass:"cinema-stock-edit-text"},[e._v("\n          "+e._s(e.showPlanDate)+"\n        ")])]),e._v(" "),i("el-form-item",{attrs:{label:"影片间隔："}},[i("span",{staticClass:"cinema-stock-edit-text"},[e._v("\n          "+e._s(e.movieData.intervalMinute)+"分钟\n        ")])])],1)],1),e._v(" "),e.isEditMode&&0==e.movieData.soldSeatCount?i("div",{staticClass:"basic-info"},[i("div",{staticClass:"base-info-title"},[e._v("选择连排影片 "),i("el-button",{attrs:{disabled:"STOP"==e.movieData.saleStatus},on:{click:e.showAddFilmDialog}},[e._v("添加影片")])],1),e._v(" "),i("el-table",{attrs:{data:e.movieTable}},[i("el-table-column",{attrs:{prop:"showIndex",label:"放映顺序"}}),e._v(" "),i("el-table-column",{attrs:{prop:"movieName",label:"放映影片名称"}}),e._v(" "),i("el-table-column",{attrs:{prop:"movieLanguage",label:"放映影片语言"}}),e._v(" "),i("el-table-column",{attrs:{prop:"timeLong",label:"时长(分钟)"}}),e._v(" "),i("el-table-column",{attrs:{label:"放映时间"},scopedSlots:e._u([{key:"default",fn:function(t){return[e._v("\n          "+e._s(t.row.startTime)+"-"+e._s(t.row.endTime)+"\n        ")]}}],null,!1,3920100082)}),e._v(" "),i("el-table-column",{attrs:{label:"操作"},scopedSlots:e._u([{key:"default",fn:function(t){return[i("el-button",{staticStyle:{padding:"0"},attrs:{type:"text",disabled:"STOP"==e.movieData.saleStatus},on:{click:function(i){return e.deleteIndex(t.$index)}}},[e._v("删除")]),e._v(" "),t.$index&&e.movieTable.length>1?i("el-button",{staticStyle:{padding:"0"},attrs:{type:"text",icon:"el-icon-top",disabled:"STOP"==e.movieData.saleStatus},on:{click:function(i){return e.changeIndex("top",t.$index)}}},[e._v("上移")]):e._e(),e._v(" "),t.$index!=e.movieTable.length-1&&e.movieTable.length>1?i("el-button",{staticStyle:{padding:"0"},attrs:{type:"text",icon:"el-icon-bottom",disabled:"STOP"==e.movieData.saleStatus},on:{click:function(i){return e.changeIndex("down",t.$index)}}},[e._v("下移")]):e._e()]}}],null,!1,1426373657)})],1)],1):i("div",{staticClass:"basic-info"},[i("div",{staticClass:"base-info-title"},[e._v("连排影片")]),e._v(" "),i("el-table",{attrs:{data:e.movieTable}},[i("el-table-column",{attrs:{prop:"showIndex",label:"放映顺序"}}),e._v(" "),i("el-table-column",{attrs:{prop:"movieName",label:"放映影片名称"}}),e._v(" "),i("el-table-column",{attrs:{prop:"movieLanguage",label:"放映影片语言"}}),e._v(" "),i("el-table-column",{attrs:{prop:"timeLong",label:"时长(分钟)"}}),e._v(" "),i("el-table-column",{attrs:{label:"放映时间"},scopedSlots:e._u([{key:"default",fn:function(t){return[e._v("\n          "+e._s(t.row.startTime)+"-"+e._s(t.row.endTime)+"\n        ")]}}])})],1)],1),e._v(" "),i("div",{directives:[{name:"show",rawName:"v-show",value:e.isEditMode,expression:"isEditMode"}],staticClass:"basic-info"},[i("div",{staticClass:"base-info-title"},[e._v("票价方案设置")]),e._v(" "),i("el-tabs",{attrs:{type:"card"},model:{value:e.activeTab,callback:function(t){e.activeTab=t},expression:"activeTab"}},[i("el-tab-pane",{attrs:{label:"柜台/自助",name:"first"}},[i("el-form",{attrs:{"label-width":"80px"}},[i("el-form-item",{attrs:{label:"适用票类："}},[i("div",[i("el-table",{ref:"ticketMultipleTable",staticStyle:{width:"100%"},attrs:{data:e.ticketData,"tooltip-effect":"dark","row-key":"id"},on:{"selection-change":e.ticketSelChange}},[i("el-table-column",{attrs:{type:"selection",selectable:e.rowIsDisabled,width:"55"}}),e._v(" "),i("el-table-column",{attrs:{prop:"name",label:"票类名称",width:"100"}}),e._v(" "),i("el-table-column",{attrs:{prop:"price",label:"票类价格"},scopedSlots:e._u([{key:"default",fn:function(t){return[i("span",{staticClass:"input-con"},[i("el-input",{attrs:{type:"number",maxlength:"4",max:"1000"},on:{blur:function(i){return e.tableFixed(t)}},model:{value:t.row.price,callback:function(i){e.$set(t.row,"price",i)},expression:"scope.row.price"}}),i("i",{staticClass:"rmb-hover"},[e._v("¥")])],1)]}}])})],1),e._v(" "),i("p",{staticClass:"table-rule"},[e._v("1、若价格方案的定价低于最低发行价时，将以影片最低发行价出售")]),e._v(" "),i("p",{staticClass:"table-rule"},[e._v("2、场次标准票价=场次成人票票价")])],1)])],1)],1),e._v(" "),i("el-tab-pane",{attrs:{label:"线上网售",name:"second"}},[i("el-form",{attrs:{"label-width":"80px"}},[i("el-form-item",{attrs:{label:"适用渠道："}},[i("div",[i("el-table",{ref:"channelMultipleTable",staticClass:"edit-cichannel-table",staticStyle:{width:"100%"},attrs:{data:e.channelData,"tooltip-effect":"dark","row-key":"uid"},on:{"selection-change":e.channelSelChange}},[i("el-table-column",{attrs:{type:"selection",width:"55"}}),e._v(" "),i("el-table-column",{attrs:{prop:"name",label:"代理商",width:"100"}}),e._v(" "),i("el-table-column",{attrs:{prop:"price",label:"渠道价格"},scopedSlots:e._u([{key:"default",fn:function(t){return[i("span",{staticClass:"input-con"},[i("el-input",{attrs:{type:"number",maxlength:"4",max:"1000"},on:{blur:function(i){return e.cichannelToFixed(t)}},model:{value:t.row.price,callback:function(i){e.$set(t.row,"price",i)},expression:"scope.row.price"}}),i("i",{staticClass:"rmb-hover"},[e._v("¥")])],1)]}}])})],1),e._v(" "),i("p",{staticClass:"table-rule"},[e._v("1、若价格方案的定价低于最低发行价时，将以影片最低发行价出售")]),e._v(" "),i("p",{staticClass:"table-rule"},[e._v("2、场次标准票价=场次成人票票价")])],1)])],1)],1)],1)],1),e._v(" "),i("div",{directives:[{name:"show",rawName:"v-show",value:!e.isEditMode,expression:"!isEditMode"}],staticClass:"basic-info"},[i("div",{staticClass:"base-info-title"},[e._v("票价方案")]),e._v(" "),i("el-tabs",{attrs:{type:"card"},model:{value:e.activeTab,callback:function(t){e.activeTab=t},expression:"activeTab"}},[i("el-tab-pane",{attrs:{label:"柜台/自助",name:"first"}},[i("el-form",{attrs:{"label-width":"80px"}},[i("el-form-item",{attrs:{label:"适用票类："}},[i("div",[i("el-table",{staticStyle:{width:"100%"},attrs:{data:e.ticketData,"tooltip-effect":"dark"},on:{"selection-change":e.ticketSelChange}},[i("el-table-column",{attrs:{prop:"name",label:"票类名称",width:"100"}}),e._v(" "),i("el-table-column",{attrs:{prop:"price",label:"票类价格(元)"},scopedSlots:e._u([{key:"default",fn:function(t){return[i("span",{staticClass:"input-con"},[e._v(e._s(t.row.price))])]}}])}),e._v(" "),i("el-table-column",{attrs:{label:"开售状态"},scopedSlots:e._u([{key:"default",fn:function(t){return[i("span",{staticClass:"input-con"},[e._v(e._s(t.row.switchStatus?"开售":"停售"))])]}}])})],1),e._v(" "),i("p",{staticClass:"table-rule"},[e._v("1、若价格方案的定价低于最低发行价时，将以影片最低发行价出售")]),e._v(" "),i("p",{staticClass:"table-rule"},[e._v("2、场次标准票价=场次成人票票价")])],1)])],1)],1),e._v(" "),i("el-tab-pane",{attrs:{label:"线上网售",name:"second"}},[i("el-form",{attrs:{"label-width":"80px"}},[i("el-form-item",{attrs:{label:"适用渠道："}},[i("div",[i("el-table",{staticClass:"edit-cichannel-table",staticStyle:{width:"100%"},attrs:{data:e.channelData,"tooltip-effect":"dark"}},[i("el-table-column",{attrs:{prop:"name",label:"代理商",width:"100"}}),e._v(" "),i("el-table-column",{attrs:{prop:"price",label:"渠道价格(元)"},scopedSlots:e._u([{key:"default",fn:function(t){return[i("span",{staticClass:"input-con"},[e._v(e._s(t.row.price))])]}}])}),e._v(" "),i("el-table-column",{attrs:{label:"开售状态"},scopedSlots:e._u([{key:"default",fn:function(t){return[i("span",{staticClass:"input-con"},[e._v(e._s(t.row.switchStatus?"开售":"停售"))])]}}])})],1),e._v(" "),i("p",{staticClass:"table-rule"},[e._v("1、若价格方案的定价低于最低发行价时，将以影片最低发行价出售")]),e._v(" "),i("p",{staticClass:"table-rule"},[e._v("2、场次标准票价=场次成人票票价")])],1)])],1)],1)],1)],1),e._v(" "),e.isEditMode?i("div",{staticClass:"basic-info"},[i("div",{staticClass:"base-info-title"},[e._v("分账比例、最低票价、分摊比例设置")]),e._v(" "),i("el-table",{attrs:{data:e.movieTable}},[i("el-table-column",{attrs:{prop:"showIndex",label:"序号",width:"100"}}),e._v(" "),i("el-table-column",{attrs:{prop:"movieName",label:"放映影片名称",width:"100"}}),e._v(" "),i("el-table-column",{attrs:{label:"票价分摊比例(%)"},scopedSlots:e._u([{key:"default",fn:function(t){return[i("span",{staticClass:"input-con"},[i("el-input",{attrs:{type:"number",maxlength:"3",max:"100"},on:{blur:function(i){return e.percentTableToFixed(t)}},model:{value:t.row.percentPrice,callback:function(i){e.$set(t.row,"percentPrice",i)},expression:"scope.row.percentPrice"}})],1)]}}],null,!1,1605592399)}),e._v(" "),i("el-table-column",{attrs:{label:"最低票价(元)"},scopedSlots:e._u([{key:"default",fn:function(t){return[i("span",{staticClass:"input-con"},[i("el-input",{attrs:{type:"number",maxlength:"4",max:"1000"},on:{blur:function(i){return e.percentTableToFixed(t)}},model:{value:t.row.minPrice,callback:function(i){e.$set(t.row,"minPrice",i)},expression:"scope.row.minPrice"}})],1)]}}],null,!1,424952969)}),e._v(" "),i("el-table-column",{attrs:{label:"分账比例(%)"},scopedSlots:e._u([{key:"default",fn:function(t){return[i("span",{staticClass:"input-con"},[i("el-input",{attrs:{type:"number",maxlength:"3",max:"100"},on:{blur:function(i){return e.percentTableToFixed(t)}},model:{value:t.row.publisherRate,callback:function(i){e.$set(t.row,"publisherRate",i)},expression:"scope.row.publisherRate"}})],1)]}}],null,!1,825862229)})],1),e._v(" "),i("div",{staticClass:"table-bottom-menu"},[i("div",{staticClass:"prcie-promise"},[i("el-checkbox",{model:{value:e.mustRightSeat,callback:function(t){e.mustRightSeat=t},expression:"mustRightSeat"}},[e._v("对号入座")])],1),e._v(" "),i("div",{staticClass:"prcie-promise"},[i("el-checkbox",{model:{value:e.permitSaleBox,callback:function(t){e.permitSaleBox=t},expression:"permitSaleBox"}},[e._v("允许包厢单卖")])],1),e._v(" "),i("div",{staticClass:"prcie-promise"},[i("el-checkbox",{model:{value:e.permitDiscount,callback:function(t){e.permitDiscount=t},expression:"permitDiscount"}},[e._v("允许营销活动折扣、会员折扣")])],1),e._v(" "),i("div",{staticClass:"prcie-promise"},[e._v("审核状态: "+e._s(e.approveStatus))])])],1):i("div",{staticClass:"basic-info"},[i("div",{staticClass:"base-info-title"},[e._v("分账比例、最低票价、分摊比例")]),e._v(" "),i("el-table",{attrs:{data:e.movieTable}},[i("el-table-column",{attrs:{prop:"showIndex",label:"序号",width:"100"}}),e._v(" "),i("el-table-column",{attrs:{prop:"movieName",label:"放映影片名称",width:"100"}}),e._v(" "),i("el-table-column",{attrs:{label:"票价分摊比例(%)"},scopedSlots:e._u([{key:"default",fn:function(t){return[i("span",{staticClass:"input-con"},[e._v(e._s(t.row.percentPrice))])]}}])}),e._v(" "),i("el-table-column",{attrs:{label:"最低票价(元)"},scopedSlots:e._u([{key:"default",fn:function(t){return[i("span",{staticClass:"input-con"},[e._v(e._s(t.row.minPrice))])]}}])}),e._v(" "),i("el-table-column",{attrs:{label:"分账比例(%)"},scopedSlots:e._u([{key:"default",fn:function(t){return[i("span",{staticClass:"input-con"},[e._v(e._s(t.row.publisherRate))])]}}])})],1),e._v(" "),i("div",{staticClass:"table-bottom-menu"},[i("div",{staticClass:"prcie-promise"},[e._v("\n        对号入座: "),i("span",[e._v(e._s(e.mustRightSeat?"是":"否"))])]),e._v(" "),i("div",{staticClass:"prcie-promise"},[e._v("\n        允许包厢单卖: "),i("span",[e._v(e._s(e.permitSaleBox?"是":"否"))])]),e._v(" "),i("div",{staticClass:"prcie-promise"},[e._v("\n        允许营销活动折扣、会员折扣: "),i("span",[e._v(e._s(e.permitDiscount?"是":"否"))])]),e._v(" "),i("div",{staticClass:"prcie-promise"},[e._v("审核状态: "+e._s(e.approveStatus))])])],1),e._v(" "),e.isEditMode?i("div",{staticClass:"basic-info"},[i("div",{staticClass:"base-info-title"},[e._v("开售渠道选择")]),e._v(" "),i("el-checkbox",{attrs:{indeterminate:e.isIndeterminate},on:{change:e.handleCheckAllChange},model:{value:e.checkAll,callback:function(t){e.checkAll=t},expression:"checkAll"}},[e._v("全选")]),e._v(" "),i("div",{staticStyle:{margin:"15px 0"}}),e._v(" "),i("el-checkbox-group",{on:{change:e.handleCheckedChannelChange},model:{value:e.channelMulData,callback:function(t){e.channelMulData=t},expression:"channelMulData"}},e._l(e.mulCheckedData,function(t){return i("el-checkbox",{key:t.uid,attrs:{label:t.uid},on:{change:function(i){return e.singleCheckChange(t.uid)}}},[e._v(e._s(t.name))])}),1),e._v(" "),i("div")],1):e._e(),e._v(" "),i("el-dialog",{staticClass:"add-movie-dialog",attrs:{title:"添加影片",width:"60%",visible:e.addMovieDialog},on:{"update:visible":function(t){e.addMovieDialog=t},close:e.closeDialogCb}},[i("el-form",[i("el-form-item",{staticClass:"serach-con"},[i("div",{staticClass:"search-wrap"},[i("span",[e._v("影片名称：")]),e._v(" "),i("el-input",{model:{value:e.searchMovieName,callback:function(t){e.searchMovieName=t},expression:"searchMovieName"}})],1),e._v(" "),i("el-button",{attrs:{type:"primary",icon:"el-icon-search"},on:{click:e.getMovieData}},[e._v("查询")])],1),e._v(" "),i("el-form-item",[i("el-table",{ref:"multipleTable",staticStyle:{width:"100%"},attrs:{data:e.addMovieTable,"tooltip-effect":"dark"},on:{"selection-change":e.handleSelectionChange}},[i("el-table-column",{attrs:{type:"selection",width:"55"}}),e._v(" "),i("el-table-column",{attrs:{prop:"movieName",label:"影片名称",width:"200"}}),e._v(" "),i("el-table-column",{attrs:{prop:"disVersion",label:"发行版本",width:"70"}}),e._v(" "),i("el-table-column",{attrs:{prop:"moviedesclanguage",label:"语言",width:"70"}}),e._v(" "),i("el-table-column",{attrs:{prop:"timeLong",label:"时长",width:"70"}}),e._v(" "),i("el-table-column",{attrs:{label:"有效期"},scopedSlots:e._u([{key:"default",fn:function(t){return[e._v(e._s(t.row.dateShowFirst.split(" ")[0])+" 至 "+e._s(t.row.dateShowOff.split(" ")[0]))]}}])})],1)],1)],1),e._v(" "),i("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[i("el-button",{on:{click:function(t){e.addMovieDialog=!1}}},[e._v("取 消")]),e._v(" "),i("el-button",{attrs:{type:"primary"},on:{click:e.addMovieData}},[e._v("确 定")])],1)],1),e._v(" "),i("div",{staticClass:"bottom-handler-tool",style:{width:e.fixedWidth+"px"}},[e.isEditMode?i("div",{staticClass:"btn-area"},[i("el-button",{attrs:{type:"primary"},on:{click:e.savePlan}},[e._v("保存")]),e._v(" "),i("el-button",{on:{click:e.cancelHandle}},[e._v("取消")])],1):i("div",{staticClass:"btn-area"},[i("el-button",{on:{click:e.closePage}},[e._v("关闭")])],1)])],1)},a=[],o={render:n,staticRenderFns:a};t.a=o}});