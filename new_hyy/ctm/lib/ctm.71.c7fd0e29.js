webpackJsonpctm([71],{169:function(t,e,n){"use strict";function o(t){n(474)}Object.defineProperty(e,"__esModule",{value:!0});var a=n(345),r=n(476),i=n(3),l=o,s=i(a.a,r.a,!1,l,null,null);e.default=s.exports},345:function(t,e,n){"use strict";var o=n(72);n.n(o);e.a={name:"Control",components:{singleCinema:o.singleCinema},data:function(){return{singleCinemaVisible:!1,singleCinemaType:2,innerData:{id:""},cinemaName:"",totalHallNum:"",totalSeatNum:"",formData:{cinemaUid:"",date:new Date},headerData:["星期日","星期一","星期二","星期三","星期四","星期五","星期六"],bodyData:[],startShowDate:0}},methods:{callBackSingle:function(t){this.singleCinemaVisible=t.framedialogVisible,t.isCloseWindow||(console.log(t,"-----\x3e data"),this.cinemaName=t.data.name,this.formData.cinemaUid=t.data.id,this.innerData.id=t.data.id,this.getSchreportCalendar(),this.getCinemaHallSeat())},mGetDate:function(t,e){return new Date(t,e,0).getDate()},changeDate:function(t){var e=0;e=t?this.mGetDate(this.formData.date.getFullYear(),this.formData.date.getMonth()+1):this.mGetDate(this.formData.date.getFullYear(),this.formData.date.getMonth()?this.formData.date.getMonth():12),this.formData.date=new Date(Date.parse(this.formData.date)+(t?60*e*60*24*1e3:60*-e*60*24*1e3)),this.initBodyData(),this.getSchreportCalendar()},report:function(t){if(console.log(t),t)this.schreportReport([t]);else{var e=[];this.bodyData.forEach(function(t){t.reportDate&&Date.parse(t.reportDate)<(new Date).getTime()-864e5&&e.push(t.reportDate)}),console.log(e),e.length>0?this.schreportReport(e):this.warning("当月暂无数据，无法上报！")}},schreportReport:function(t){var e=this;this.$ctmList.schreportReport({dateList:t,cinemaUid:this.formData.cinemaUid}).then(function(t){console.log(t),200===t.code?(e.getSchreportCalendar(),e.success(t.msg)):e.error(t.msg)}).catch(function(t){console.log(t)})},getCinemaHallSeat:function(){var t=this;this.$ctmList.getCinemaHallSeat({cinemaUid:this.formData.cinemaUid}).then(function(e){console.log(e),200===e.code?(t.totalHallNum=e.data.totalHallNum,t.totalSeatNum=e.data.totalSeatNum):t.error(e.msg)}).catch(function(t){console.log(t)})},dateChange:function(){this.initBodyData(),this.getSchreportCalendar()},getSchreportCalendar:function(){var t=this,e={cinemaUid:this.formData.cinemaUid,year:this.formData.date.getFullYear().toString(),month:this.formData.date.getMonth()+1};console.log(e),this.$ctmList.getSchreportCalendar(e).then(function(e){console.log(e),200===e.code?(t.startShowDate=e.data.startShowDate,e.data.calendarList.forEach(function(e){t.bodyData.some(function(n,o){if(e.reportDate===n.reportDate)return t.$set(t.bodyData[o],"reportStatus",e.reportStatus),!0})}),console.log(t.bodyData,"bodyData")):t.error(e.msg)}).catch(function(t){console.log(t)})},initBodyData:function(){var t=this,e=this.formData.date.getMonth()+1,n=new Date(Date.parse(this.formData.date.getFullYear()+"-"+(this.formData.date.getMonth()+1)+"-01")),o=new Array(n.getDay()).fill({}),a=0;switch(e){case 1:case 3:case 5:case 7:case 8:case 10:case 12:a=31;break;case 4:case 6:case 9:case 11:a=30;break;case 2:a=this.formData.date.getFullYear()%4==0?29:28}var r=new Array(a).fill({}).map(function(n,o){return{reportDate:t.formData.date.getFullYear()+"-"+(e>9?e:"0"+e)+"-"+(o+1>9?o+1:"0"+(o+1))}}),i=6-new Date(Date.parse(r[r.length-1].reportDate)).getDay(),l=o.concat(r,new Array(i).fill({}));this.bodyData=l,console.log(this.bodyData,"bodyData")}},mounted:function(){var t=this;this.initBodyData(),this.$ctmList.getUserInfo().then(function(e){console.log(e),200===e.code?(t.formData.cinemaUid=e.data.cinemaUid,t.innerData.id=Number(e.data.cinemaUid),t.cinemaName=e.data.cinemaName,t.getSchreportCalendar(),t.getCinemaHallSeat()):t.error(e.msg)}).catch(function(t){console.log(t)})}}},474:function(t,e,n){var o=n(475);"string"==typeof o&&(o=[[t.i,o,""]]),o.locals&&(t.exports=o.locals);n(157)("e3f848d8",o,!0,{})},475:function(t,e,n){e=t.exports=n(156)(!0),e.push([t.i,"\n.control .icon-report-success {\n  position: absolute;\n  right: 0;\n  top: 0;\n  color: #05e043;\n  font-size: 16px;\n}\n.control .icon-report-failed {\n  position: absolute;\n  right: 0;\n  top: 0;\n  color: #fc4040;\n  font-size: 16px;\n}\n.control .icon-reporting {\n  position: absolute;\n  right: 0;\n  top: 0;\n  color: #3b74ff;\n  font-size: 16px;\n}\n.control .bg-holiday {\n  background: #f8f8f8;\n}\n.control .bg-today {\n  background: #f2f4fd;\n}\n.control .table-header {\n  border-bottom: 1px solid #bcbcbc;\n}\n.control .table-header .table-header-content {\n    text-align: center;\n    height: 32px;\n    line-height: 32px;\n    float: left;\n    width: 14.28%;\n}\n.control .table-body {\n  border-left: 1px solid #f5f5f5;\n}\n.control .table-body .iconfont {\n    right: 50%;\n    top: 10px;\n    -webkit-transform: translateX(50%);\n            transform: translateX(50%);\n}\n.control .table-body .table-body-content {\n    position: relative;\n    padding: 10px 24px;\n    -webkit-box-sizing: border-box;\n            box-sizing: border-box;\n    float: left;\n    height: 113px;\n    width: 14.28%;\n    border-right: 1px solid #f5f5f5;\n    border-bottom: 1px solid #f5f5f5;\n}\n.control .table-body .table-body-content .table-content-title {\n      font-size: 18px;\n      color: #333;\n}\n.control .table-body .table-body-content .table-content-btn {\n      position: absolute;\n      left: 50%;\n      top: 50%;\n      -webkit-transform: translate(-50%, -50%);\n              transform: translate(-50%, -50%);\n      width: 70px;\n      height: 20px;\n      border: 1px solid #3b74ff;\n      border-radius: 2px;\n      font-size: 12px;\n      color: #3b74ff;\n      letter-spacing: 0;\n      text-align: center;\n      line-height: 20px;\n      cursor: pointer;\n}\n.control .table-body .table-body-content span {\n      font-size: 12px;\n}\n.control .layout-footer {\n  background: #f5f5f5;\n  padding: 10px 12px;\n}\n.control .layout-footer .layout-footer-text {\n    margin-right: 50px;\n    color: #3b74ff;\n}\n.control .layout-footer .layout-footer-status {\n    display: inline-block;\n    position: relative;\n    width: 80px;\n    margin-left: 20px;\n}\n","",{version:3,sources:["G:/Workspaces/work/chenxin/module-hyy/ctm/src/views/boxOfficeReport/Control.vue"],names:[],mappings:";AACA;EACE,mBAAmB;EACnB,SAAS;EACT,OAAO;EACP,eAAe;EACf,gBAAgB;CACjB;AACD;EACE,mBAAmB;EACnB,SAAS;EACT,OAAO;EACP,eAAe;EACf,gBAAgB;CACjB;AACD;EACE,mBAAmB;EACnB,SAAS;EACT,OAAO;EACP,eAAe;EACf,gBAAgB;CACjB;AACD;EACE,oBAAoB;CACrB;AACD;EACE,oBAAoB;CACrB;AACD;EACE,iCAAiC;CAClC;AACD;IACI,mBAAmB;IACnB,aAAa;IACb,kBAAkB;IAClB,YAAY;IACZ,cAAc;CACjB;AACD;EACE,+BAA+B;CAChC;AACD;IACI,WAAW;IACX,UAAU;IACV,mCAAmC;YAC3B,2BAA2B;CACtC;AACD;IACI,mBAAmB;IACnB,mBAAmB;IACnB,+BAA+B;YACvB,uBAAuB;IAC/B,YAAY;IACZ,cAAc;IACd,cAAc;IACd,gCAAgC;IAChC,iCAAiC;CACpC;AACD;MACM,gBAAgB;MAChB,YAAY;CACjB;AACD;MACM,mBAAmB;MACnB,UAAU;MACV,SAAS;MACT,yCAAyC;cACjC,iCAAiC;MACzC,YAAY;MACZ,aAAa;MACb,0BAA0B;MAC1B,mBAAmB;MACnB,gBAAgB;MAChB,eAAe;MACf,kBAAkB;MAClB,mBAAmB;MACnB,kBAAkB;MAClB,gBAAgB;CACrB;AACD;MACM,gBAAgB;CACrB;AACD;EACE,oBAAoB;EACpB,mBAAmB;CACpB;AACD;IACI,mBAAmB;IACnB,eAAe;CAClB;AACD;IACI,sBAAsB;IACtB,mBAAmB;IACnB,YAAY;IACZ,kBAAkB;CACrB",file:"Control.vue",sourcesContent:["\n.control .icon-report-success {\n  position: absolute;\n  right: 0;\n  top: 0;\n  color: #05e043;\n  font-size: 16px;\n}\n.control .icon-report-failed {\n  position: absolute;\n  right: 0;\n  top: 0;\n  color: #fc4040;\n  font-size: 16px;\n}\n.control .icon-reporting {\n  position: absolute;\n  right: 0;\n  top: 0;\n  color: #3b74ff;\n  font-size: 16px;\n}\n.control .bg-holiday {\n  background: #f8f8f8;\n}\n.control .bg-today {\n  background: #f2f4fd;\n}\n.control .table-header {\n  border-bottom: 1px solid #bcbcbc;\n}\n.control .table-header .table-header-content {\n    text-align: center;\n    height: 32px;\n    line-height: 32px;\n    float: left;\n    width: 14.28%;\n}\n.control .table-body {\n  border-left: 1px solid #f5f5f5;\n}\n.control .table-body .iconfont {\n    right: 50%;\n    top: 10px;\n    -webkit-transform: translateX(50%);\n            transform: translateX(50%);\n}\n.control .table-body .table-body-content {\n    position: relative;\n    padding: 10px 24px;\n    -webkit-box-sizing: border-box;\n            box-sizing: border-box;\n    float: left;\n    height: 113px;\n    width: 14.28%;\n    border-right: 1px solid #f5f5f5;\n    border-bottom: 1px solid #f5f5f5;\n}\n.control .table-body .table-body-content .table-content-title {\n      font-size: 18px;\n      color: #333;\n}\n.control .table-body .table-body-content .table-content-btn {\n      position: absolute;\n      left: 50%;\n      top: 50%;\n      -webkit-transform: translate(-50%, -50%);\n              transform: translate(-50%, -50%);\n      width: 70px;\n      height: 20px;\n      border: 1px solid #3b74ff;\n      border-radius: 2px;\n      font-size: 12px;\n      color: #3b74ff;\n      letter-spacing: 0;\n      text-align: center;\n      line-height: 20px;\n      cursor: pointer;\n}\n.control .table-body .table-body-content span {\n      font-size: 12px;\n}\n.control .layout-footer {\n  background: #f5f5f5;\n  padding: 10px 12px;\n}\n.control .layout-footer .layout-footer-text {\n    margin-right: 50px;\n    color: #3b74ff;\n}\n.control .layout-footer .layout-footer-status {\n    display: inline-block;\n    position: relative;\n    width: 80px;\n    margin-left: 20px;\n}\n"],sourceRoot:""}])},476:function(t,e,n){"use strict";var o=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"control"},[n("singleCinema",{ref:"frameSingleCinema",attrs:{framedialogVisible:t.singleCinemaVisible,type:t.singleCinemaType,innerData:t.innerData},on:{"update:framedialogVisible":function(e){t.singleCinemaVisible=e},"update:framedialog-visible":function(e){t.singleCinemaVisible=e},callBackSingle:t.callBackSingle}},[n("div",{attrs:{slot:"footerId"},slot:"footerId"},[n("el-button",{attrs:{type:"primary"},on:{click:function(e){t.$refs.frameSingleCinema.confirmData(),t.singleCinemaVisible=!1}}},[t._v("确 定")]),t._v(" "),n("el-button",{on:{click:function(e){t.singleCinemaVisible=!1}}},[t._v("取 消")])],1)]),t._v(" "),n("el-form",{staticClass:"demo-form-inline search-form",attrs:{inline:!0,model:t.formData,size:"small"}},[n("el-form-item",{attrs:{label:"影院名称："}},[n("el-button",{staticClass:"single-cinema-button",on:{click:function(e){t.singleCinemaVisible=!0,t.$refs.frameSingleCinema.listAuthCommCinemas()}}},[t._v(t._s(t.cinemaName))])],1),t._v(" "),n("el-form-item",[n("i",{staticClass:"el-icon-arrow-left",on:{click:function(e){return t.changeDate(!1)}}}),t._v(" "),n("el-date-picker",{staticClass:"month",attrs:{type:"month",clearable:!1,editable:!1,placeholder:"请选择"},on:{change:t.dateChange},model:{value:t.formData.date,callback:function(e){t.$set(t.formData,"date",e)},expression:"formData.date"}}),t._v(" "),n("i",{staticClass:"el-icon-arrow-right",on:{click:function(e){return t.changeDate(!0)}}})],1)],1),t._v(" "),n("div",{staticClass:"table-header clearfix"},t._l(t.headerData,function(e){return n("div",{key:e,staticClass:"table-header-content",style:{color:"星期六"===e||"星期日"===e?"#999":"#666"}},[t._v(t._s(e))])}),0),t._v(" "),n("div",{staticClass:"table-body clearfix"},t._l(t.bodyData,function(e,o){return n("div",{key:o,class:["table-body-content",{"bg-holiday":o%7==0||o%7==6},{"bg-today":new Date(Date.parse(e.reportDate)).toDateString()===(new Date).toDateString()}]},[Date.parse(t.startShowDate)<=Date.parse(e.reportDate)&&Date.parse(e.reportDate)<(new Date).getTime()-792e5&&"0"!=e.reportStatus?n("div",{class:["iconfont",{"icon-report-success":3==e.reportStatus},{"icon-report-failed":!e.reportStatus||2==e.reportStatus},{"icon-reporting":1==e.reportStatus}]}):t._e(),t._v(" "),n("span",{staticClass:"table-content-title"},[t._v(t._s(e.reportDate?e.reportDate.split("-")[2]>9?e.reportDate.split("-")[2]:e.reportDate.split("-")[2].split("")[1]:""))]),t._v(" "),Date.parse(t.startShowDate)<=Date.parse(e.reportDate)&&Date.parse(e.reportDate)<(new Date).getTime()-792e5&&"0"!=e.reportStatus?n("div",{staticClass:"table-content-btn",on:{click:function(n){return t.report(e.reportDate)}}},[t._v("重新上报")]):t._e(),t._v(" "),Date.parse(t.startShowDate)<=Date.parse(e.reportDate)&&Date.parse(e.reportDate)<(new Date).getTime()-792e5&&"0"==e.reportStatus?n("div",{staticClass:"table-content-btn",on:{click:function(n){return t.report(e.reportDate)}}},[t._v("上报")]):t._e()])}),0),t._v(" "),n("el-row",{staticClass:"layout-footer",attrs:{type:"flex",justify:"space-between"}},[n("el-col",{attrs:{span:12}},[t._v("\n      影厅总数："),n("span",{staticClass:"layout-footer-text"},[t._v(t._s(t.totalHallNum))]),t._v("\n      座位总数："),n("span",{staticClass:"layout-footer-text"},[t._v(t._s(t.totalSeatNum))])]),t._v(" "),n("el-col",{attrs:{span:12}},[n("div",{staticStyle:{float:"right"}},[n("div",{staticClass:"layout-footer-status"},[t._v("\n          上报成功 "),n("div",{staticClass:"iconfont icon-report-success"})]),t._v(" "),n("div",{staticClass:"layout-footer-status"},[t._v("\n          上报失败 "),n("div",{staticClass:"iconfont icon-report-failed"})]),t._v(" "),n("div",{staticClass:"layout-footer-status"},[t._v("\n          正在上报 "),n("div",{staticClass:"iconfont icon-reporting"})])])])],1)],1)},a=[],r={render:o,staticRenderFns:a};e.a=r}});