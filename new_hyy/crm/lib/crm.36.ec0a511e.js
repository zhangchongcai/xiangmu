webpackJsonpcrm([36],{155:function(e,t,a){"use strict";function r(e){a(373)}Object.defineProperty(t,"__esModule",{value:!0});var o=a(227),l=a(375),i=a(8),n=r,s=i(o.a,l.a,!1,n,null,null);t.default=s.exports},227:function(e,t,a){"use strict";var r=a(53),o=a.n(r);t.a={name:"MemberList",data:function(){return{historyVisible:!1,logList:[],historyTotal:0,logData:{tenantId:this.$store.state.loginUser.consumerId,current:1,size:20,cardNo:"",memberId:""},tipMessage:"暂无数据",tenantId:this.$store.state.loginUser.consumerId,currentPage:1,records:[],pickerOptions:{shortcuts:[{text:"最近一周",onClick:function(e){var t=new Date,a=new Date;a.setTime(a.getTime()-6048e5),e.$emit("pick",[a,t])}},{text:"最近一个月",onClick:function(e){var t=new Date,a=new Date;a.setTime(a.getTime()-2592e6),e.$emit("pick",[a,t])}},{text:"最近三个月",onClick:function(e){var t=new Date,a=new Date;a.setTime(a.getTime()-7776e6),e.$emit("pick",[a,t])}}]},memberLevelRuleVOList:[],sourceOptions:[],formData:{date:[(new Date).addMonths(-1),new Date],startOpenDate:(new Date).addDays(-30).formatDate("yyyy-MM-dd"),endOpenDate:(new Date).addDays(-1).formatDate("yyyy-MM-dd"),levelId:"",source:"",memberIdOrPhone:"",size:20,total:0}}},created:function(){this.channelList(),this.getLevelDetail(),this.search()},filters:{formatMemberInfo:function(e){if(null==(e=JSON.parse(o()(e))))return"-";var t=[];for(var a in e){var r="";switch(a){case"sex":r="性别：";break;case"name":r="姓名：";break;case"birthday":r="生日：";break;case"email":r="邮箱：";break;case"mobileNum":r="手机号：";break;case"creditNum":r="身份证号：";break;case"levelName":r="会员等级：";break;case"scoreBalance":case"totalScore":e[a]=null}null!=e[a]&&t.push(r+e[a])}return t.join(" , ")}},methods:{getLevelDetail:function(){var e=this;this.$crmList.getLevelDetail({tenantId:this.tenantId}).then(function(t){e.memberLevelRuleVOList=t.memberLevelRuleVOList?t.memberLevelRuleVOList:[{levelNo:"1",levelName:"普通会员"}]})},channelList:function(){var e=this;e.$crmList.channelList({tenantId:e.tenantId}).then(function(t){e.sourceOptions=t})},search:function(){if(null==this.formData.date)return this.$message.warning("请选择注册时间"),!1;var e=this,t={tenantId:e.tenantId,channelId:e.formData.source,current:e.currentPage,size:e.formData.size,startOpenDate:this.formData.date[0].formatDate("yyyy-MM-dd"),endOpenDate:this.formData.date[1].formatDate("yyyy-MM-dd"),levelId:e.formData.levelId,memberIdOrMobileNum:e.formData.memberIdOrPhone};e.tipMessage="数据加载中...",e.$crmList.memberListPage(t).then(function(t){0!=t.total&&null!=t.data||(e.tipMessage="暂无数据"),e.records=t.records,e.formData.total=t.total}).catch(function(t){t&&t.msg?e.tipMessage=t.msg:e.tipMessage="系统繁忙，请稍后重试！"})},searchMember:function(){this.currentPage=1,this.search()},resetForm:function(e){this.$refs[e].resetFields()},handleSizeChange:function(e){this.formData.size=e,this.search()},handleCurrentChange:function(e){this.currentPage=e,this.search()},handleDialogSizeChange:function(e){this.logData.size=e,this.historysearch()},handleDialogCurrentChange:function(e){this.logData.current=e,this.historysearch()},handleMemberDetail:function(e){this.$router.push({path:"/member/member/detail",query:{levelNo:e.levelId,id:e.id,startOpenDate:this.formData.date[0].formatDate("yyyy-MM-dd"),endOpenDate:this.formData.date[1].formatDate("yyyy-MM-dd")}})},historysearch:function(){var e=this;this.historyVisible=!0,this.tipMessage="数据加载中...",this.$crmList.memberLogListPage(this.logData).then(function(t){0==t.total&&(e.tipMessage="暂无数据"),e.logList=t.records,e.historyTotal=t.total}).catch(function(t){t&&t.msg?e.tipMessage=t.msg:e.tipMessage="系统繁忙，请稍后重试！"})},handleChangeHistory:function(e){this.logData={tenantId:this.tenantId,current:1,size:20,cardNo:e.cardNum,memberId:e.id},this.historysearch()},formateEmpty:function(e,t,a,r){return null==a||void 0==a||""===a?"-":a}}}},373:function(e,t,a){var r=a(374);"string"==typeof r&&(r=[[e.i,r,""]]),r.locals&&(e.exports=r.locals);a(132)("178e6f7c",r,!0,{})},374:function(e,t,a){t=e.exports=a(131)(!0),t.push([e.i,"\n.member-list .result-title {\n  font-size: 12px;\n  color: #b1b1b1;\n  padding: 8px 0;\n}\n._mbmber-history-visible .el-dialog {\n  height: 576px;\n}\n._mbmber-history-visible .el-dialog__header {\n  padding: 10px 20px;\n}\n._mbmber-history-visible .el-dialog__body {\n  padding: 0px 20px;\n}\n._mbmber-history-visible .el-dialog__footer {\n  text-align: center;\n}\n._mbmber-history-visible .__table-wrap {\n  border-top: 1px solid #f5f5f5;\n  padding-top: 10px;\n}\n._mbmber-history-visible .__table-wrap .el-form-item {\n    margin: 0 5px 5px 0;\n}\n._mbmber-history-visible .__table-wrap .heightBug input {\n    height: 32px !important;\n}\n._mbmber-history-visible .__table-wrap ._history-dialog-paginatioin {\n    padding: 6px 0;\n    border: 1px solid #e5e5e5;\n    border-top: 0;\n}\n._mbmber-history-visible .__table-wrap .el-table__body-wrapper {\n    overflow-y: auto;\n    height: 380px;\n}\n._mbmber-history-visible .__table-wrap .el-table__body-wrapper .el-table__body {\n      border-collapse: collapse;\n}\n._mbmber-history-visible .__table-wrap .el-table__body-wrapper .el-table__body tbody tr:last-child {\n        border-bottom: 1px solid #f0f0f0;\n}\n","",{version:3,sources:["G:/Workspaces/work/chenxin/module-hyy/crm/src/views/member/memberInfo/MemberList.vue"],names:[],mappings:";AACA;EACE,gBAAgB;EAChB,eAAe;EACf,eAAe;CAChB;AACD;EACE,cAAc;CACf;AACD;EACE,mBAAmB;CACpB;AACD;EACE,kBAAkB;CACnB;AACD;EACE,mBAAmB;CACpB;AACD;EACE,8BAA8B;EAC9B,kBAAkB;CACnB;AACD;IACI,oBAAoB;CACvB;AACD;IACI,wBAAwB;CAC3B;AACD;IACI,eAAe;IACf,0BAA0B;IAC1B,cAAc;CACjB;AACD;IACI,iBAAiB;IACjB,cAAc;CACjB;AACD;MACM,0BAA0B;CAC/B;AACD;QACQ,iCAAiC;CACxC",file:"MemberList.vue",sourcesContent:["\n.member-list .result-title {\n  font-size: 12px;\n  color: #b1b1b1;\n  padding: 8px 0;\n}\n._mbmber-history-visible .el-dialog {\n  height: 576px;\n}\n._mbmber-history-visible .el-dialog__header {\n  padding: 10px 20px;\n}\n._mbmber-history-visible .el-dialog__body {\n  padding: 0px 20px;\n}\n._mbmber-history-visible .el-dialog__footer {\n  text-align: center;\n}\n._mbmber-history-visible .__table-wrap {\n  border-top: 1px solid #f5f5f5;\n  padding-top: 10px;\n}\n._mbmber-history-visible .__table-wrap .el-form-item {\n    margin: 0 5px 5px 0;\n}\n._mbmber-history-visible .__table-wrap .heightBug input {\n    height: 32px !important;\n}\n._mbmber-history-visible .__table-wrap ._history-dialog-paginatioin {\n    padding: 6px 0;\n    border: 1px solid #e5e5e5;\n    border-top: 0;\n}\n._mbmber-history-visible .__table-wrap .el-table__body-wrapper {\n    overflow-y: auto;\n    height: 380px;\n}\n._mbmber-history-visible .__table-wrap .el-table__body-wrapper .el-table__body {\n      border-collapse: collapse;\n}\n._mbmber-history-visible .__table-wrap .el-table__body-wrapper .el-table__body tbody tr:last-child {\n        border-bottom: 1px solid #f0f0f0;\n}\n"],sourceRoot:""}])},375:function(e,t,a){"use strict";var r=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"member-list"},[a("el-form",{ref:"formData",staticClass:"form-data-wrap _member-search-area-custom",attrs:{inline:!0,model:e.formData}},[a("el-form-item",{attrs:{label:"注册时间：",prop:"date"}},[a("el-date-picker",{attrs:{type:"daterange",align:"right","unlink-panels":"","range-separator":"至","start-placeholder":"开始日期","end-placeholder":"结束日期","picker-options":e.pickerOptions},model:{value:e.formData.date,callback:function(t){e.$set(e.formData,"date",t)},expression:"formData.date"}})],1),e._v(" "),a("el-form-item",{attrs:{label:"会员ID/手机号：",prop:"memberIdOrPhone"}},[a("el-input",{attrs:{placeholder:"会员ID/手机号",clearable:""},on:{blur:function(){e.formData.memberIdOrPhone=e.formData.memberIdOrPhone.trim()}},model:{value:e.formData.memberIdOrPhone,callback:function(t){e.$set(e.formData,"memberIdOrPhone",t)},expression:"formData.memberIdOrPhone"}})],1),e._v(" "),a("el-form-item",{attrs:{label:"会员等级：",prop:"levelId"}},[a("el-select",{attrs:{placeholder:"全部等级",clearable:""},model:{value:e.formData.levelId,callback:function(t){e.$set(e.formData,"levelId",t)},expression:"formData.levelId"}},e._l(e.memberLevelRuleVOList,function(e){return a("el-option",{key:e.levelNo,attrs:{label:e.levelName,value:e.levelNo}})}),1)],1),e._v(" "),a("el-form-item",{attrs:{label:"来源：",prop:"source"}},[a("el-select",{attrs:{placeholder:"全部来源",clearable:""},model:{value:e.formData.source,callback:function(t){e.$set(e.formData,"source",t)},expression:"formData.source"}},e._l(e.sourceOptions,function(e){return a("el-option",{key:e.code,attrs:{label:e.desc,value:e.code}})}),1)],1),e._v(" "),a("el-form-item",[a("el-button",{staticClass:"_el-btn-custom",attrs:{type:"primary"},on:{click:e.searchMember}},[e._v("搜索")]),e._v(" "),a("el-button",{staticClass:"_el-btn-custom _member-custom-ghost-button",attrs:{plain:""},on:{click:function(t){return e.resetForm("formData")}}},[e._v("重置\n      ")])],1)],1),e._v(" "),e.formData.total?a("div",{staticClass:"result-title"},[e._v("为您查询到"+e._s(e.formData.total)+"个会员信息")]):e._e(),e._v(" "),a("div",{staticClass:"_m-member-table-custom"},[a("el-table",{staticStyle:{width:"100%"},attrs:{data:e.records,stripe:"","empty-text":e.tipMessage}},[a("el-table-column",{attrs:{prop:"id",label:"会员ID","min-width":"140",formatter:e.formateEmpty,"show-overflow-tooltip":""}}),e._v(" "),a("el-table-column",{attrs:{prop:"name",label:"姓名","min-width":"120",formatter:e.formateEmpty,"show-overflow-tooltip":""}}),e._v(" "),a("el-table-column",{attrs:{prop:"mobileNum",label:"手机号","min-width":"120",formatter:e.formateEmpty,"show-overflow-tooltip":""}}),e._v(" "),a("el-table-column",{attrs:{prop:"sex",label:"性别","min-width":"80",formatter:e.formateEmpty}}),e._v(" "),a("el-table-column",{attrs:{prop:"birthday",label:"生日","min-width":"100",formatter:e.formateEmpty,"show-overflow-tooltip":""}}),e._v(" "),a("el-table-column",{attrs:{prop:"levelName",label:"会员等级","min-width":"100",formatter:e.formateEmpty,"show-overflow-tooltip":""}}),e._v(" "),a("el-table-column",{attrs:{prop:"totalBalance",label:"储值余额","min-width":"100",formatter:e.formateEmpty,"show-overflow-tooltip":""}}),e._v(" "),a("el-table-column",{attrs:{prop:"giveBalance",label:"赠送金额","min-width":"100",formatter:e.formateEmpty,"show-overflow-tooltip":""}}),e._v(" "),a("el-table-column",{attrs:{prop:"scoreBalance",label:"积分余额","min-width":"100",formatter:e.formateEmpty,"show-overflow-tooltip":""}}),e._v(" "),a("el-table-column",{attrs:{prop:"openDate",label:"注册时间","min-width":"100",formatter:e.formateEmpty,"show-overflow-tooltip":""}}),e._v(" "),a("el-table-column",{attrs:{prop:"channelName",label:"全部来源","min-width":"100",formatter:e.formateEmpty,"show-overflow-tooltip":""}}),e._v(" "),a("el-table-column",{attrs:{fixed:"right",label:"操作","min-width":"120"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("span",{staticStyle:{color:"#3B74FF",cursor:"pointer",fontSize:"12px"},on:{click:function(a){return e.handleMemberDetail(t.row)}}},[e._v("详情")]),e._v(" "),a("span",{staticStyle:{color:"#3B74FF",cursor:"pointer",fontSize:"12px","margin-left":"10px"},on:{click:function(a){return e.handleChangeHistory(t.row)}}},[e._v("变更历史")])]}}])})],1)],1),e._v(" "),a("div",{staticClass:"page-wrap"},[a("el-pagination",{attrs:{background:"","current-page":e.currentPage-0,"page-size":e.formData.size-0,layout:"total, sizes, prev, pager, next, jumper","page-sizes":[20,50,100],total:e.formData.total-0},on:{"size-change":e.handleSizeChange,"current-change":e.handleCurrentChange}})],1),e._v(" "),a("el-dialog",{staticClass:"_mbmber-history-visible",attrs:{title:"变更历史",visible:e.historyVisible,width:"896px"},on:{"update:visible":function(t){e.historyVisible=t}}},[a("div",{staticClass:"__table-wrap"},[a("div",{staticClass:"_m-member-table-custom"},[a("el-table",{staticStyle:{width:"100%"},attrs:{data:e.logList,stripe:"","empty-text":e.tipMessage}},[a("el-table-column",{attrs:{prop:"operateTime",label:"操作时间","min-width":"140",formatter:e.formateEmpty,"show-overflow-tooltip":""}}),e._v(" "),a("el-table-column",{attrs:{prop:"operateTypeName",label:"操作类型","min-width":"90",formatter:e.formateEmpty,"show-overflow-tooltip":""}}),e._v(" "),a("el-table-column",{attrs:{prop:"oldMemberInfo",label:"操作前","min-width":"105",formatter:e.formateEmpty,"show-overflow-tooltip":""},scopedSlots:e._u([{key:"default",fn:function(t){return[e._v("\n              "+e._s(e._f("formatMemberInfo")(t.row.oldMemberInfo))+"\n            ")]}}])}),e._v(" "),a("el-table-column",{attrs:{prop:"memberInfo",label:"操作后","min-width":"105",formatter:e.formateEmpty,"show-overflow-tooltip":""},scopedSlots:e._u([{key:"default",fn:function(t){return[e._v("\n              "+e._s(e._f("formatMemberInfo")(t.row.memberInfo))+"\n            ")]}}])}),e._v(" "),a("el-table-column",{attrs:{prop:"channelName",label:"操作渠道","min-width":"95",formatter:e.formateEmpty,"show-overflow-tooltip":""}}),e._v(" "),a("el-table-column",{attrs:{prop:"operator",label:"操作人","min-width":"95",formatter:e.formateEmpty,"show-overflow-tooltip":""}})],1)],1),e._v(" "),a("div",{staticClass:"page-wrap _history-dialog-paginatioin"},[a("el-pagination",{attrs:{background:"","current-page":e.logData.current-0,"page-size":e.logData.size-0,layout:"total, prev, pager, next, jumper","page-sizes":[20,50,100],total:e.historyTotal-0},on:{"size-change":e.handleDialogSizeChange,"current-change":e.handleDialogCurrentChange}})],1)]),e._v(" "),a("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{staticClass:"_el-btn-custom",attrs:{size:"medium"},on:{click:function(t){e.historyVisible=!1}}},[e._v("关闭")])],1)])],1)},o=[],l={render:r,staticRenderFns:o};t.a=l}});