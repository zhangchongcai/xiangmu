webpackJsonpcrm([40],{163:function(t,e,a){"use strict";function s(t){a(398)}Object.defineProperty(e,"__esModule",{value:!0});var r=a(235),n=a(400),o=a(8),l=s,i=o(r.a,n.a,!1,l,null,null);e.default=i.exports},235:function(t,e,a){"use strict";var s=a(53),r=a.n(s);e.a={name:"CardList",data:function(){return{setDefaultDialog:!1,setDefaultInfo:"",stopStartDialog:!1,statusFlag:"",stopStartInfo:"",tipMessage:"",total:0,formData:{cardProductName:"",cardType:"",channelNo:"",status:"",current:1,size:20,tenantId:this.$store.state.loginUser.consumerId},tableData:[],cardTypeOptions:[],cardStatusOptions:[],sourceOptions:[]}},mounted:function(){this.search(),this.handleChannelList(),this.handleCardType(),this.handleCardStatus()},filters:{judegStatus:function(t){return"unstart"==t?"未启用":"start"==t?"已启用":"stop"==t?"已停用":"-"},formatCreateTime:function(t){return t?new Date(t.replace(/-/g,"/")).formatDate("yyyy-MM-dd"):"-"},formatdefaultCard:function(t){return 0==t?"否":1==t?"是":"-"},formatCardTypeCode:function(t){switch(t){case"stored_card":return"储值卡";case"equity_card":return"权益卡";case"cobranded_card":return"联名卡";case"times_card":return"次卡";case"gift_card":return"礼品卡";case"month_card":return"包月卡";default:return"-"}}},methods:{search:function(){var t=this,e=JSON.parse(r()(this.formData));this.tipMessage="数据加载中...",this.$crmList.getCardTypeList(e).then(function(e){0==e.total&&(t.tipMessage="暂无数据"),t.tableData=e.records,t.total=e.total}).catch(function(e){console.log(e),e&&e.msg?t.tipMessage=e.msg:t.tipMessage="系统繁忙，请稍后重试！"})},handleSearch:function(){this.formData.current=1,this.search()},resetForm:function(t){this.$refs[t].resetFields()},handleChannelList:function(){var t={tenantId:this.$store.state.loginUser.consumerId},e=this;e.$crmList.channelList(t).then(function(t){e.sourceOptions=t})},handleCardType:function(){var t={tenantId:this.$store.state.loginUser.consumerId},e=this;e.$crmList.getCardType(t).then(function(t){e.cardTypeOptions=t})},handleCardStatus:function(){var t={tenantId:this.$store.state.loginUser.consumerId},e=this;e.$crmList.getCardStatus(t).then(function(t){e.cardStatusOptions=t})},handleSizeChange:function(t){this.formData.size=t,this.search()},handleCurrentChange:function(t){this.formData.current=t,this.search()},handleMemberDetail:function(t){this.$router.push({path:"/member/cardTypeManagement/detail",query:{cardProductId:t.id}})},handleAddCardType:function(){this.$router.push({path:"/member/cardTypeManagement/addCardType"})},handleEmitCardType:function(t){this.$router.push({path:"/member/cardTypeManagement/editCardType",query:{cardId:t.id}})},handleChangeStatus:function(t,e){this.stopStartDialog=!0,this.statusFlag=t,this.stopStartInfo=e},handleSureChangeStatus:function(){var t=this;this.stopStartDialog=!1;var e={status:"start"==this.statusFlag?"start":"stop",id:this.stopStartInfo.id,tenantId:this.$store.state.loginUser.consumerId};this.$crmList.changeCardTypeStatus(e).then(function(){t.search(),t.$message({type:"success",message:"start"==t.statusFlag?"已启用":"已停用"})}).catch(function(t){return console.log(t)})},handleSetDefault:function(t){this.setDefaultDialog=!0,this.setDefaultInfo=t},handleSureSetDefault:function(){var t=this;this.setDefaultDialog=!1;var e={tenantId:this.$store.state.loginUser.consumerId,id:this.setDefaultInfo.id};this.$crmList.setDefaultCard(e).then(function(){t.search(),t.$message.success("设置成功")}).catch(function(e){console.log(e),t.$message.error("设置失败，请重试")})},formateEmpty:function(t,e,a,s){return null==a||void 0==a||""===a?"-":a}}}},398:function(t,e,a){var s=a(399);"string"==typeof s&&(s=[[t.i,s,""]]),s.locals&&(t.exports=s.locals);a(132)("6e76efc2",s,!0,{})},399:function(t,e,a){e=t.exports=a(131)(!0),e.push([t.i,"\n.member-list .add-btn {\n  font-size: 12px;\n  padding: 6px 0;\n  text-align: right;\n}\n.member-list .add-btn .add-button-custom {\n    font-size: 12px;\n    width: 96px;\n    padding: 5px 20px;\n}\n.member-list .member-list-table .unstart {\n  color: #739bff;\n}\n.member-list .member-list-table .start {\n  color: #2dbc2d;\n}\n.member-list .member-list-table .stop {\n  color: #f33430;\n}\n.member-list .member-list-table .operation-button span {\n  font-size: 12px;\n}\n","",{version:3,sources:["G:/Workspaces/work/chenxin/module-hyy/crm/src/views/member/cardTypeManagement/cardList.vue"],names:[],mappings:";AACA;EACE,gBAAgB;EAChB,eAAe;EACf,kBAAkB;CACnB;AACD;IACI,gBAAgB;IAChB,YAAY;IACZ,kBAAkB;CACrB;AACD;EACE,eAAe;CAChB;AACD;EACE,eAAe;CAChB;AACD;EACE,eAAe;CAChB;AACD;EACE,gBAAgB;CACjB",file:"cardList.vue",sourcesContent:["\n.member-list .add-btn {\n  font-size: 12px;\n  padding: 6px 0;\n  text-align: right;\n}\n.member-list .add-btn .add-button-custom {\n    font-size: 12px;\n    width: 96px;\n    padding: 5px 20px;\n}\n.member-list .member-list-table .unstart {\n  color: #739bff;\n}\n.member-list .member-list-table .start {\n  color: #2dbc2d;\n}\n.member-list .member-list-table .stop {\n  color: #f33430;\n}\n.member-list .member-list-table .operation-button span {\n  font-size: 12px;\n}\n"],sourceRoot:""}])},400:function(t,e,a){"use strict";var s=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"member-list"},[a("el-form",{ref:"formData",staticClass:"form-data-wrap _member-search-area-custom",attrs:{inline:!0,model:t.formData}},[a("el-form-item",{attrs:{label:"可售渠道：",prop:"channelNo"}},[a("el-select",{attrs:{placeholder:"全部渠道",clearable:""},model:{value:t.formData.channelNo,callback:function(e){t.$set(t.formData,"channelNo",e)},expression:"formData.channelNo"}},t._l(t.sourceOptions,function(t){return a("el-option",{key:t.code,attrs:{label:t.desc,value:t.code}})}),1)],1),t._v(" "),a("el-form-item",{attrs:{label:"卡类型：",prop:"cardType"}},[a("el-select",{attrs:{placeholder:"全部类型",clearable:""},model:{value:t.formData.cardType,callback:function(e){t.$set(t.formData,"cardType",e)},expression:"formData.cardType"}},t._l(t.cardTypeOptions,function(t){return a("el-option",{key:t.code,attrs:{label:t.desc,value:t.code}})}),1)],1),t._v(" "),a("el-form-item",{attrs:{label:"卡状态：",prop:"status"}},[a("el-select",{attrs:{placeholder:"全部状态",clearable:""},model:{value:t.formData.status,callback:function(e){t.$set(t.formData,"status",e)},expression:"formData.status"}},t._l(t.cardStatusOptions,function(t){return a("el-option",{key:t.code,attrs:{label:t.desc,value:t.code}})}),1)],1),t._v(" "),a("el-form-item",{attrs:{label:"政策名称：",prop:"cardProductName"}},[a("el-input",{attrs:{placeholder:"填写政策名称",clearable:""},on:{blur:function(){t.formData.cardProductName=t.formData.cardProductName.trim()}},model:{value:t.formData.cardProductName,callback:function(e){t.$set(t.formData,"cardProductName",e)},expression:"formData.cardProductName"}})],1),t._v(" "),a("el-form-item",{staticClass:"btn-wrap"},[a("el-button",{staticClass:"_el-btn-custom",attrs:{type:"primary"},on:{click:t.handleSearch}},[t._v("搜索")]),t._v(" "),a("el-button",{staticClass:"_el-btn-custom _member-custom-ghost-button",attrs:{plain:""},on:{click:function(e){return t.resetForm("formData")}}},[t._v("重置\n      ")])],1)],1),t._v(" "),a("div",{staticClass:"add-btn"},[a("el-button",{staticClass:"_el-btn-custom _member-custom-ghost-button",attrs:{plain:!0},on:{click:t.handleAddCardType}},[t._v("新建\n    ")])],1),t._v(" "),a("div",{staticClass:"member-list-table _m-member-table-custom"},[a("el-table",{staticStyle:{width:"100%"},attrs:{data:t.tableData,stripe:"","empty-text":t.tipMessage}},[a("el-table-column",{attrs:{prop:"productNo",label:"政策编号","min-width":"120",formatter:t.formateEmpty,"show-overflow-tooltip":""}}),t._v(" "),a("el-table-column",{attrs:{prop:"cardName",label:"政策名称","min-width":"120",formatter:t.formateEmpty,"show-overflow-tooltip":""}}),t._v(" "),a("el-table-column",{attrs:{prop:"cardTypeCode",label:"卡类型","min-width":"100",formatter:t.formateEmpty,"show-overflow-tooltip":""},scopedSlots:t._u([{key:"default",fn:function(e){return[t._v(t._s(t._f("formatCardTypeCode")(e.row.cardTypeCode)))]}}])}),t._v(" "),a("el-table-column",{attrs:{prop:"channelType",label:"可售渠道","min-width":"120",formatter:t.formateEmpty,"show-overflow-tooltip":""}}),t._v(" "),a("el-table-column",{attrs:{prop:"createTime",label:"创建时间","min-width":"120","show-overflow-tooltip":""},scopedSlots:t._u([{key:"default",fn:function(e){return[t._v(t._s(t._f("formatCreateTime")(e.row.createTime)))]}}])}),t._v(" "),a("el-table-column",{attrs:{prop:"status",label:"状态","min-width":"100","show-overflow-tooltip":""},scopedSlots:t._u([{key:"default",fn:function(e){return[a("span",{class:"unstart"==e.row.status?"unstart":"start"==e.row.status?"start":"stop",staticStyle:{fontSize:"12px"}},[t._v(t._s(t._f("judegStatus")(e.row.status)))])]}}])}),t._v(" "),a("el-table-column",{attrs:{prop:"defaultCard",label:"默认政策","min-width":"100","show-overflow-tooltip":""},scopedSlots:t._u([{key:"default",fn:function(e){return[t._v(t._s(t._f("formatdefaultCard")(e.row.defaultCard)))]}}])}),t._v(" "),a("el-table-column",{attrs:{fixed:"right",label:"操作","min-width":"165"},scopedSlots:t._u([{key:"default",fn:function(e){return[a("el-button",{staticClass:"operation-button",attrs:{type:"text",size:"small"},on:{click:function(a){return t.handleMemberDetail(e.row)}}},[t._v("查看\n          ")]),t._v(" "),"unstart"==e.row.status?a("el-button",{staticClass:"operation-button",attrs:{type:"text",size:"small"},on:{click:function(a){return t.handleEmitCardType(e.row)}}},[t._v("编辑")]):t._e(),t._v(" "),"unstart"==e.row.status?a("el-button",{staticClass:"operation-button",attrs:{type:"text",size:"small"},on:{click:function(a){return t.handleChangeStatus("start",e.row)}}},[t._v("启用")]):t._e(),t._v(" "),"start"==e.row.status?a("el-button",{staticClass:"operation-button",attrs:{type:"text",size:"small"},on:{click:function(a){return t.handleChangeStatus("stop",e.row)}}},[t._v("停用")]):t._e(),t._v(" "),"stored_card"==e.row.cardTypeCode&&"start"==e.row.status&&0==e.row.defaultCard?a("el-button",{staticClass:"operation-button",attrs:{type:"text",size:"small"},on:{click:function(a){return t.handleSetDefault(e.row)}}},[t._v("\n            设为默认")]):t._e()]}}])})],1)],1),t._v(" "),a("div",{staticClass:"page-wrap"},[a("el-pagination",{attrs:{background:"","current-page":t.formData.current-0,"page-size":t.formData.size-0,layout:"total, sizes, prev, pager, next, jumper","page-sizes":[20,50,100],total:t.total-0},on:{"size-change":t.handleSizeChange,"current-change":t.handleCurrentChange}})],1),t._v(" "),a("el-dialog",{staticClass:"_member-tip-dialog-custom-style",attrs:{title:"",visible:t.stopStartDialog,width:"320px","show-close":!1},on:{"update:visible":function(e){t.stopStartDialog=e}}},[a("i",{staticClass:"iconfont icon-danchuang-tishi _member-tip-dialog-icon"}),t._v(" "),a("span",{staticClass:"_member-tip-dialog-desc"},[t._v("确定要"+t._s("start"==t.statusFlag?"启用":"停用")+" "+t._s(t.stopStartInfo.cardName)+" 吗？")]),t._v(" "),a("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{staticClass:"_el-btn-custom _member-add-edit-save-btn",attrs:{type:"primary"},on:{click:t.handleSureChangeStatus}},[t._v("确定\n      ")]),t._v(" "),a("el-button",{staticClass:"_el-btn-custom _member-add-edit-save-btn",on:{click:function(e){t.stopStartDialog=!1}}},[t._v("取消")])],1)]),t._v(" "),a("el-dialog",{staticClass:"_member-tip-dialog-custom-style",attrs:{title:"",visible:t.setDefaultDialog,width:"320px","show-close":!1},on:{"update:visible":function(e){t.setDefaultDialog=e}}},[a("i",{staticClass:"iconfont icon-danchuang-tishi _member-tip-dialog-icon"}),t._v(" "),a("span",{staticClass:"_member-tip-dialog-desc"},[t._v("是否取消之前的默认政策设置，将此条政策设为默认？")]),t._v(" "),a("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{staticClass:"_el-btn-custom _member-add-edit-save-btn",attrs:{type:"primary"},on:{click:t.handleSureSetDefault}},[t._v("确定\n      ")]),t._v(" "),a("el-button",{staticClass:"_el-btn-custom _member-add-edit-save-btn",on:{click:function(e){t.setDefaultDialog=!1}}},[t._v("取消")])],1)])],1)},r=[],n={render:s,staticRenderFns:r};e.a=n}});